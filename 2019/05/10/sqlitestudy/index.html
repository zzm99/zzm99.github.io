<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/touxiang.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Chapter 1SQLite 命令与关系数据库进行交互的标准 SQLite 命令类似于 SQL。命令包括 CREATE、SELECT、INSERT、UPDATE、DELETE 和 DROP。这些命令基于它们的操作性质可分为以下几种：">
<meta property="og:type" content="article">
<meta property="og:title" content="sqlite入门学习">
<meta property="og:url" content="http://yoursite.com/2019/05/10/sqlitestudy/index.html">
<meta property="og:site_name" content="zzm99">
<meta property="og:description" content="Chapter 1SQLite 命令与关系数据库进行交互的标准 SQLite 命令类似于 SQL。命令包括 CREATE、SELECT、INSERT、UPDATE、DELETE 和 DROP。这些命令基于它们的操作性质可分为以下几种：">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-05-12T06:23:13.023Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sqlite入门学习">
<meta name="twitter:description" content="Chapter 1SQLite 命令与关系数据库进行交互的标准 SQLite 命令类似于 SQL。命令包括 CREATE、SELECT、INSERT、UPDATE、DELETE 和 DROP。这些命令基于它们的操作性质可分为以下几种：">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/05/10/sqlitestudy/">






  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "29501955"
    });
  daovoice('update');
  </script>

  <title>sqlite入门学习 | zzm99</title>
  








</head>


<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zzm99</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/sqlitestudy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zzm99">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zzm99">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">sqlite入门学习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-10T19:26:10+08:00">
                2019-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/sqlite/" itemprop="url" rel="index">
                    <span itemprop="name">sqlite</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/05/10/sqlitestudy/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/10/sqlitestudy/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  26.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  115
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Chapter-1"><a href="#Chapter-1" class="headerlink" title="Chapter 1"></a>Chapter 1</h1><h2 id="SQLite-命令"><a href="#SQLite-命令" class="headerlink" title="SQLite 命令"></a>SQLite 命令</h2><p>与关系数据库进行交互的标准 SQLite 命令类似于 SQL。命令包括 <strong>CREATE、SELECT、INSERT、UPDATE、DELETE 和 DROP</strong>。这些命令基于它们的操作性质可分为以下几种：<br><a id="more"></a></p>
<h3 id="DDL-数据定义语言DDL-数据定义语言"><a href="#DDL-数据定义语言DDL-数据定义语言" class="headerlink" title="DDL - 数据定义语言DDL - 数据定义语言"></a>DDL - 数据定义语言DDL - 数据定义语言</h3><table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE</td>
<td>创建一个新的表，一个表的视图，或者数据库中的其他对象。</td>
</tr>
<tr>
<td>ALTER</td>
<td>修改数据库中的某个已有的数据库对象，比如一个表。</td>
</tr>
<tr>
<td>DROP</td>
<td>删除整个表，或者表的视图，或者数据库中的其他对象。</td>
</tr>
</tbody>
</table>
<h3 id="DML-数据操作语言"><a href="#DML-数据操作语言" class="headerlink" title="DML - 数据操作语言"></a>DML - 数据操作语言</h3><table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>INSERT</td>
<td>创建一条记录。</td>
</tr>
<tr>
<td>UPDATE</td>
<td>修改记录。</td>
</tr>
<tr>
<td>DELETE</td>
<td>删除记录。</td>
</tr>
</tbody>
</table>
<h3 id="DQL-数据查询语言"><a href="#DQL-数据查询语言" class="headerlink" title="DQL - 数据查询语言"></a>DQL - 数据查询语言</h3><table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>SELECT</td>
<td>从一个或多个表中检索某些记录。</td>
</tr>
</tbody>
</table>
<h1 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h1><h2 id="SQLite-命令-1"><a href="#SQLite-命令-1" class="headerlink" title="SQLite 命令"></a>SQLite 命令</h2><p>本章将向您讲解 SQLite 编程人员所使用的简单却有用的命令。这些命令被称为 <strong>SQLite 的点命令</strong>，这些命令的不同之处在于它们<strong>不以分号 ; 结束</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ sqlite3</span><br><span class="line">SQLite version 3.3.6</span><br><span class="line">Enter &quot;.help&quot; for instructions</span><br><span class="line">sqlite&gt;</span><br><span class="line"></span><br><span class="line">如需获取可用的点命令的清单，可以在任何时候输入 &quot;.help&quot;。</span><br><span class="line"></span><br><span class="line">sqlite&gt;.help</span><br><span class="line">上面的命令会显示各种重要的 SQLite 点命令的列表</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">让我们尝试使用 .show 命令，来查看 SQLite 命令提示符的默认设置。</span><br><span class="line"></span><br><span class="line">sqlite&gt;.show</span><br><span class="line">     echo: off</span><br><span class="line">         eqp: off</span><br><span class="line">     explain: auto</span><br><span class="line">     headers: off</span><br><span class="line">        mode: list</span><br><span class="line">   nullvalue: &quot;&quot;</span><br><span class="line">      output: stdout</span><br><span class="line">colseparator: &quot;|&quot;</span><br><span class="line">rowseparator: &quot;\n&quot;</span><br><span class="line">       stats: off</span><br><span class="line">       width:</span><br><span class="line">    filename: :memory:</span><br><span class="line">sqlite&gt;</span><br><span class="line"></span><br><span class="line">确保 sqlite&gt; 提示符与点命令之间没有空格，否则将无法正常工作。</span><br></pre></td></tr></table></figure>
<h2 id="格式化输出"><a href="#格式化输出" class="headerlink" title="格式化输出"></a>格式化输出</h2><p>可以使用下列的点命令来格式化输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.header on</span><br><span class="line">sqlite&gt;.mode column</span><br><span class="line">sqlite&gt;.timer on</span><br><span class="line">sqlite&gt;</span><br></pre></td></tr></table></figure>
<p>上面设置将产生如下格式的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">CPU Time: user 0.000000 sys 0.000000</span><br></pre></td></tr></table></figure>
<h2 id="sqlite-master-表格"><a href="#sqlite-master-表格" class="headerlink" title="sqlite_master 表格"></a>sqlite_master 表格</h2><p>主表中保存数据库表的关键信息，并把它命名为 sqlite_master。如要查看表概要，可按如下操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.schema sqlite_master</span><br><span class="line">这将产生如下结果：</span><br><span class="line"></span><br><span class="line">CREATE TABLE sqlite_master (</span><br><span class="line">  type text,</span><br><span class="line">  name text,</span><br><span class="line">  tbl_name text,</span><br><span class="line">  rootpage integer,</span><br><span class="line">  sql text</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h1 id="Chapter-3"><a href="#Chapter-3" class="headerlink" title="Chapter 3"></a>Chapter 3</h1><h2 id="SQLite-语法"><a href="#SQLite-语法" class="headerlink" title="SQLite 语法"></a>SQLite 语法</h2><h3 id="大小写敏感性"><a href="#大小写敏感性" class="headerlink" title="大小写敏感性"></a>大小写敏感性</h3><p>有个重要的点值得注意，SQLite 是不区分大小写的，但也有一些命令是大小写敏感的，比如 GLOB 和 glob 在 SQLite 的语句中有不同的含义。</p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>SQLite 注释是附加的注释，可以在 SQLite 代码中添加注释以增加其可读性，他们可以出现在任何空白处，包括在表达式内和其他 SQL 语句的中间，但它们不能嵌套。</p>
<p>SQL 注释以两个连续的 “-“ 字符（ASCII 0x2d）开始，并扩展至下一个换行符（ASCII 0x0a）或直到输入结束，以先到者为准。</p>
<p>您也可以使用 C 风格的注释，以 “/<em>“ 开始，并扩展至下一个 “</em>/“ 字符对或直到输入结束，以先到者为准。SQLite的注释可以跨越多行。</p>
<ul>
<li>sqlite&gt;.help – 这是一个简单的注释</li>
</ul>
<h3 id="SQLite-语句"><a href="#SQLite-语句" class="headerlink" title="SQLite 语句"></a>SQLite 语句</h3><p>所有的 SQLite 语句可以以任何关键字开始，如<strong> SELECT、INSERT、UPDATE、DELETE、ALTER、DROP</strong> 等，<strong>所有的语句以分号（;）</strong>结束。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line">SQLite ANALYZE 语句：</span><br><span class="line"></span><br><span class="line">ANALYZE;</span><br><span class="line">or</span><br><span class="line">ANALYZE database_name;</span><br><span class="line">or</span><br><span class="line">ANALYZE database_name.table_name;</span><br><span class="line"></span><br><span class="line">SQLite AND/OR 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION-1 &#123;AND|OR&#125; CONDITION-2;</span><br><span class="line"></span><br><span class="line">SQLite ALTER TABLE 语句：</span><br><span class="line"></span><br><span class="line">ALTER TABLE table_name ADD COLUMN column_def...;</span><br><span class="line"></span><br><span class="line">SQLite ALTER TABLE 语句（Rename）：</span><br><span class="line"></span><br><span class="line">ALTER TABLE table_name RENAME TO new_table_name;</span><br><span class="line"></span><br><span class="line">SQLite ATTACH DATABASE 语句：</span><br><span class="line"></span><br><span class="line">ATTACH DATABASE &apos;DatabaseName&apos; As &apos;Alias-Name&apos;;</span><br><span class="line"></span><br><span class="line">SQLite BEGIN TRANSACTION 语句：</span><br><span class="line"></span><br><span class="line">BEGIN;</span><br><span class="line">or</span><br><span class="line">BEGIN EXCLUSIVE TRANSACTION;</span><br><span class="line"></span><br><span class="line">SQLite BETWEEN 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name BETWEEN val-1 AND val-2;</span><br><span class="line"></span><br><span class="line">SQLite COMMIT 语句：</span><br><span class="line"></span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line">SQLite CREATE INDEX 语句：</span><br><span class="line"></span><br><span class="line">CREATE INDEX index_name</span><br><span class="line">ON table_name ( column_name COLLATE NOCASE );</span><br><span class="line"></span><br><span class="line">SQLite CREATE UNIQUE INDEX 语句：</span><br><span class="line"></span><br><span class="line">CREATE UNIQUE INDEX index_name</span><br><span class="line">ON table_name ( column1, column2,...columnN);</span><br><span class="line"></span><br><span class="line">SQLite CREATE TABLE 语句：</span><br><span class="line"></span><br><span class="line">CREATE TABLE table_name(</span><br><span class="line">   column1 datatype,</span><br><span class="line">   column2 datatype,</span><br><span class="line">   column3 datatype,</span><br><span class="line">   .....</span><br><span class="line">   columnN datatype,</span><br><span class="line">   PRIMARY KEY( one or more columns )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SQLite CREATE TRIGGER 语句：</span><br><span class="line"></span><br><span class="line">CREATE TRIGGER database_name.trigger_name </span><br><span class="line">BEFORE INSERT ON table_name FOR EACH ROW</span><br><span class="line">BEGIN </span><br><span class="line">   stmt1; </span><br><span class="line">   stmt2;</span><br><span class="line">   ....</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">SQLite CREATE VIEW 语句：</span><br><span class="line"></span><br><span class="line">CREATE VIEW database_name.view_name  AS</span><br><span class="line">SELECT statement....;</span><br><span class="line"></span><br><span class="line">SQLite CREATE VIRTUAL TABLE 语句：</span><br><span class="line"></span><br><span class="line">CREATE VIRTUAL TABLE database_name.table_name USING weblog( access.log );</span><br><span class="line">or</span><br><span class="line">CREATE VIRTUAL TABLE database_name.table_name USING fts3( );</span><br><span class="line"></span><br><span class="line">SQLite COMMIT TRANSACTION 语句：</span><br><span class="line"></span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line">SQLite COUNT 子句：</span><br><span class="line"></span><br><span class="line">SELECT COUNT(column_name)</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION;</span><br><span class="line"></span><br><span class="line">SQLite DELETE 语句：</span><br><span class="line"></span><br><span class="line">DELETE FROM table_name</span><br><span class="line">WHERE  &#123;CONDITION&#125;;</span><br><span class="line"></span><br><span class="line">SQLite DETACH DATABASE 语句：</span><br><span class="line"></span><br><span class="line">DETACH DATABASE &apos;Alias-Name&apos;;</span><br><span class="line"></span><br><span class="line">SQLite DISTINCT 子句：</span><br><span class="line"></span><br><span class="line">SELECT DISTINCT column1, column2....columnN</span><br><span class="line">FROM   table_name;</span><br><span class="line"></span><br><span class="line">SQLite DROP INDEX 语句：</span><br><span class="line"></span><br><span class="line">DROP INDEX database_name.index_name;</span><br><span class="line"></span><br><span class="line">SQLite DROP TABLE 语句：</span><br><span class="line"></span><br><span class="line">DROP TABLE database_name.table_name;</span><br><span class="line"></span><br><span class="line">SQLite DROP VIEW 语句：</span><br><span class="line"></span><br><span class="line">DROP VIEW view_name;</span><br><span class="line"></span><br><span class="line">SQLite DROP TRIGGER 语句：</span><br><span class="line"></span><br><span class="line">DROP TRIGGER trigger_name</span><br><span class="line"></span><br><span class="line">SQLite EXISTS 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name EXISTS (SELECT * FROM   table_name );</span><br><span class="line"></span><br><span class="line">SQLite EXPLAIN 语句：</span><br><span class="line"></span><br><span class="line">EXPLAIN INSERT statement...;</span><br><span class="line">or </span><br><span class="line">EXPLAIN QUERY PLAN SELECT statement...;</span><br><span class="line"></span><br><span class="line">SQLite GLOB 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name GLOB &#123; PATTERN &#125;;</span><br><span class="line"></span><br><span class="line">SQLite GROUP BY 子句：</span><br><span class="line"></span><br><span class="line">SELECT SUM(column_name)</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION</span><br><span class="line">GROUP BY column_name;</span><br><span class="line"></span><br><span class="line">SQLite HAVING 子句：</span><br><span class="line"></span><br><span class="line">SELECT SUM(column_name)</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION</span><br><span class="line">GROUP BY column_name</span><br><span class="line">HAVING (arithematic function condition);</span><br><span class="line"></span><br><span class="line">SQLite INSERT INTO 语句：</span><br><span class="line"></span><br><span class="line">INSERT INTO table_name( column1, column2....columnN)</span><br><span class="line">VALUES ( value1, value2....valueN);</span><br><span class="line"></span><br><span class="line">SQLite IN 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name IN (val-1, val-2,...val-N);</span><br><span class="line"></span><br><span class="line">SQLite Like 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name LIKE &#123; PATTERN &#125;;</span><br><span class="line"></span><br><span class="line">SQLite NOT IN 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  column_name NOT IN (val-1, val-2,...val-N);</span><br><span class="line"></span><br><span class="line">SQLite ORDER BY 子句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION</span><br><span class="line">ORDER BY column_name &#123;ASC|DESC&#125;;</span><br><span class="line"></span><br><span class="line">SQLite PRAGMA 语句：</span><br><span class="line"></span><br><span class="line">PRAGMA pragma_name;</span><br><span class="line"></span><br><span class="line">For example:</span><br><span class="line">PRAGMA page_size;</span><br><span class="line">PRAGMA cache_size = 1024;</span><br><span class="line">PRAGMA table_info(table_name);</span><br><span class="line"></span><br><span class="line">SQLite RELEASE SAVEPOINT 语句：</span><br><span class="line"></span><br><span class="line">RELEASE savepoint_name;</span><br><span class="line"></span><br><span class="line">SQLite REINDEX 语句：</span><br><span class="line"></span><br><span class="line">REINDEX collation_name;</span><br><span class="line">REINDEX database_name.index_name;</span><br><span class="line">REINDEX database_name.table_name;</span><br><span class="line"></span><br><span class="line">SQLite ROLLBACK 语句：</span><br><span class="line"></span><br><span class="line">ROLLBACK;</span><br><span class="line">or</span><br><span class="line">ROLLBACK TO SAVEPOINT savepoint_name;</span><br><span class="line"></span><br><span class="line">SQLite SAVEPOINT 语句：</span><br><span class="line"></span><br><span class="line">SAVEPOINT savepoint_name;</span><br><span class="line"></span><br><span class="line">SQLite SELECT 语句：</span><br><span class="line"></span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name;</span><br><span class="line"></span><br><span class="line">SQLite UPDATE 语句：</span><br><span class="line"></span><br><span class="line">UPDATE table_name</span><br><span class="line">SET column1 = value1, column2 = value2....columnN=valueN</span><br><span class="line">[ WHERE  CONDITION ];</span><br><span class="line"></span><br><span class="line">SQLite VACUUM 语句：</span><br><span class="line"></span><br><span class="line">VACUUM;</span><br><span class="line">SQLite WHERE 子句：</span><br><span class="line">SELECT column1, column2....columnN</span><br><span class="line">FROM   table_name</span><br><span class="line">WHERE  CONDITION;</span><br></pre></td></tr></table></figure>
<h1 id="Chapter-4"><a href="#Chapter-4" class="headerlink" title="Chapter 4"></a>Chapter 4</h1><h2 id="SQLite-数据类型"><a href="#SQLite-数据类型" class="headerlink" title="SQLite 数据类型"></a>SQLite 数据类型</h2><p>SQLite 数据类型是一个用来指定任何对象的数据类型的属性。SQLite 中的每一列，每个变量和表达式都有相关的数据类型。</p>
<p>您可以在创建表的同时使用这些数据类型。SQLite 使用一个更普遍的动态类型系统。在 SQLite 中，值的数据类型与值本身是相关的，而不是与它的容器相关。</p>
<h2 id="SQLite-存储类"><a href="#SQLite-存储类" class="headerlink" title="SQLite 存储类"></a>SQLite 存储类</h2><p>每个存储在 SQLite 数据库中的值都具有以下存储类之一：</p>
<table>
<thead>
<tr>
<th>存储类</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>NULL</td>
<td>值是一个 NULL 值。</td>
</tr>
<tr>
<td>INTEGER</td>
<td>值是一个带符号的整数，根据值的大小存储在 1、2、3、4、6 或 8 字节中</td>
</tr>
<tr>
<td>REAL</td>
<td>值是一个浮点值，存储为 8 字节的 IEEE 浮点数字。</td>
</tr>
<tr>
<td>TEXT</td>
<td>值是一个文本字符串，使用数据库编码（UTF-8、UTF-16BE 或 UTF-16LE）存储。</td>
</tr>
<tr>
<td>BLOB</td>
<td>值是一个 blob 数据，完全根据它的输入存储。</td>
</tr>
</tbody>
</table>
<p>SQLite 的存储类稍微比数据类型更普遍。INTEGER 存储类，例如，包含 6 种不同的不同长度的整数数据类型。</p>
<h2 id="SQLite-亲和-Affinity-类型"><a href="#SQLite-亲和-Affinity-类型" class="headerlink" title="SQLite 亲和(Affinity)类型"></a>SQLite 亲和(Affinity)类型</h2><p>SQLite支持列的亲和类型概念。任何列仍然可以存储任何类型的数据，当数据插入时，该字段的数据将会优先采用亲缘类型作为该值的存储方式。SQLite目前的版本支持以下五种亲缘类型：</p>
<ol>
<li>亲和类型    描述</li>
<li>TEXT    数值型数据在被插入之前，需要先被转换为文本格式，之后再插入到目标字段中。</li>
<li>NUMERIC    当文本数据被插入到亲缘性为NUMERIC的字段中时，如果转换操作不会导致数据信息丢失以及完全可逆，那么SQLite就会将该文本数据转换为INTEGER或REAL类型的数据，如果转换失败，SQLite仍会以TEXT方式存储该数据。对于NULL或BLOB类型的新数据，SQLite将不做任何转换，直接以NULL或BLOB的方式存储该数据。需要额外说明的是，对于浮点格式的常量文本，如”30000.0”，如果该值可以转换为INTEGER同时又不会丢失数值信息，那么SQLite就会将其转换为INTEGER的存储方式。</li>
<li>INTEGER    对于亲缘类型为INTEGER的字段，其规则等同于NUMERIC，唯一差别是在执行CAST表达式时。</li>
<li>REAL    其规则基本等同于NUMERIC，唯一的差别是不会将”30000.0”这样的文本数据转换为INTEGER存储方式。</li>
<li>NONE    不做任何的转换，直接以该数据所属的数据类型进行存储。</li>
</ol>
<h2 id="SQLite-亲和类型-Affinity-及类型名称"><a href="#SQLite-亲和类型-Affinity-及类型名称" class="headerlink" title="SQLite 亲和类型(Affinity)及类型名称"></a>SQLite 亲和类型(Affinity)及类型名称</h2><p>下表列出了当创建 SQLite3 表时可使用的各种数据类型名称，同时也显示了相应的亲和类型：</p>
<p><strong>亲和类型:</strong>INTEGER<br><strong>数据类型:</strong></p>
<ul>
<li>INT</li>
<li>INTEGER</li>
<li>TINYINT</li>
<li>SMALLINT</li>
<li>MEDIUMINT</li>
<li>BIGINT</li>
<li>UNSIGNED BIG INT</li>
<li>INT2</li>
<li>INT8</li>
</ul>
<p><strong>亲和类型:</strong>TEXT<br><strong>数据类型:</strong></p>
<ul>
<li>CHARACTER(20)</li>
<li>VARCHAR(255)</li>
<li>VARYING CHARACTER(255)</li>
<li>NCHAR(55)</li>
<li>NATIVE CHARACTER(70)</li>
<li>NVARCHAR(100)</li>
<li>TEXT</li>
<li>CLOB</li>
</ul>
<p><strong>亲和类型:</strong>NONE<br><strong>数据类型:</strong></p>
<ul>
<li>BLOB</li>
<li>no datatype specified</li>
</ul>
<p><strong>亲和类型:</strong>REAL<br><strong>数据类型:</strong></p>
<ul>
<li>REAL</li>
<li>DOUBLE</li>
<li>DOUBLE PRECISION</li>
<li>FLOAT</li>
</ul>
<p><strong>亲和类型:</strong>NUMERIC<br><strong>数据类型:</strong></p>
<ul>
<li>NUMERIC</li>
<li>DECIMAL(10,5)</li>
<li>BOOLEAN</li>
<li>DATE</li>
<li>DATETIME</li>
</ul>
<h2 id="Boolean-数据类型"><a href="#Boolean-数据类型" class="headerlink" title="Boolean 数据类型"></a>Boolean 数据类型</h2><p>SQLite 没有单独的 Boolean 存储类。相反，布尔值被存储为整数 0（false）和 1（true）。</p>
<h2 id="Date-与-Time-数据类型"><a href="#Date-与-Time-数据类型" class="headerlink" title="Date 与 Time 数据类型"></a>Date 与 Time 数据类型</h2><p>SQLite 没有一个单独的用于存储日期和/或时间的存储类，但 SQLite 能够把日期和时间存储为 TEXT、REAL 或 INTEGER 值。</p>
<ol>
<li>存储类    日期格式</li>
<li>TEXT    格式为 “YYYY-MM-DD HH:MM:SS.SSS” 的日期。</li>
<li>REAL    从公元前 4714 年 11 月 24 日格林尼治时间的正午开始算起的天数。</li>
<li>INTEGER    从 1970-01-01 00:00:00 UTC 算起的秒数。</li>
</ol>
<p>您可以以任何上述格式来存储日期和时间，并且可以使用内置的日期和时间函数来自由转换不同格式。</p>
<h1 id="Chapter-5"><a href="#Chapter-5" class="headerlink" title="Chapter 5"></a>Chapter 5</h1><h2 id="SQLite-创建数据库"><a href="#SQLite-创建数据库" class="headerlink" title="SQLite 创建数据库"></a>SQLite 创建数据库</h2><p>SQLite 的 sqlite3 命令被用来创建新的 SQLite 数据库。您不需要任何特殊的权限即可创建一个数据。</p>
<p>语法<br>sqlite3 命令的基本语法如下：</p>
<p><strong>$sqlite3 DatabaseName.db</strong></p>
<p>通常情况下，数据库名称在 RDBMS 内应该是唯一的。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>如果您想创建一个新的数据库 &lt; testDB.db &gt;，SQLITE3 语句如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sqlite3 testDB.db</span><br><span class="line">SQLite version 3.7.15.2 2013-01-09 11:53:05</span><br><span class="line">Enter &quot;.help&quot; for instructions</span><br><span class="line">Enter SQL statements terminated with a &quot;;&quot;</span><br><span class="line">sqlite&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面的命令将在<strong>当前目录</strong>下创建一个文件 testDB.db。该文件将被 SQLite 引擎用作数据库。如果您已经注意到 sqlite3 命令在成功创建数据库文件之后，将提供一个 sqlite&gt; 提示符。</p>
<p>一旦数据库被创建，您就可以使用 SQLite 的 .databases 命令来<strong>检查它是否在数据库列表中</strong>，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.databases</span><br><span class="line">seq  name             file</span><br><span class="line">---  ---------------  ----------------------</span><br><span class="line">0    main             /home/sqlite/testDB.db</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 SQLite .quit 命令退出 sqlite 提示符，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.quit</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p>
<h2 id="dump-命令"><a href="#dump-命令" class="headerlink" title=".dump 命令"></a>.dump 命令</h2><p>您可以在命令提示符中使用 <strong>SQLite .dump</strong> 点命令来<strong>导出完整的数据库在一个文本文件</strong>中，如下所示：</p>
<p><strong>$sqlite3 testDB.db .dump &gt; testDB.sql</strong></p>
<p>上面的命令将转换整个 testDB.db 数据库的内容到 SQLite 的语句中，并将其转储到 ASCII 文本文件 testDB.sql 中。您可以通过简单的方式从生成的 testDB.sql 恢复，如下所示：</p>
<p><strong>$sqlite3 testDB.db &lt; testDB.sql</strong></p>
<h1 id="Chapter-6"><a href="#Chapter-6" class="headerlink" title="Chapter 6"></a>Chapter 6</h1><h2 id="SQLite-附加数据库"><a href="#SQLite-附加数据库" class="headerlink" title="SQLite 附加数据库"></a>SQLite 附加数据库</h2><p>假设这样一种情况，当在<strong>同一时间有多个数据库可用，您想使用其中的任何一个</strong>。SQLite 的<strong> ATTACH DATABASE</strong> 语句是用来选择一个特定的数据库，使用该命令后，所有的 SQLite 语句将在附加的数据库下执行。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>SQLite 的 ATTACH DATABASE 语句的基本语法如下：</p>
<p><strong>ATTACH DATABASE ‘DatabaseName’ As ‘Alias-Name’;</strong><br>如果数据库尚未被创建，上面的命令将创建一个数据库，如果数据库已存在，则把数据库文件名称与逻辑数据库 ‘Alias-Name’ 绑定在一起。</p>
<h2 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h2><p>如果想附加一个现有的数据库 testDB.db，则 ATTACH DATABASE 语句将如下所示：</p>
<p><strong>sqlite&gt; ATTACH DATABASE ‘testDB.db’ as ‘test’;</strong><br>使用 SQLite .database 命令来显示附加的数据库。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .database</span><br><span class="line">seq  name             file</span><br><span class="line">---  ---------------  ----------------------</span><br><span class="line">0    main             /home/sqlite/testDB.db</span><br><span class="line">2    test             /home/sqlite/testDB.db</span><br></pre></td></tr></table></figure></p>
<p>数据库名称 main 和 temp 被保留用于主数据库和存储临时表及其他临时数据对象的数据库。这两个数据库名称可用于每个数据库连接，且不应该被用于附加，否则将得到一个警告消息，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;  ATTACH DATABASE &apos;testDB.db&apos; as &apos;TEMP&apos;;</span><br><span class="line">Error: database TEMP is already in use</span><br><span class="line">sqlite&gt;  ATTACH DATABASE &apos;testDB.db&apos; as &apos;main&apos;;</span><br><span class="line">Error: database main is already in use；</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-7"><a href="#Chapter-7" class="headerlink" title="Chapter 7"></a>Chapter 7</h1><h2 id="SQLite-分离数据库"><a href="#SQLite-分离数据库" class="headerlink" title="SQLite 分离数据库"></a>SQLite 分离数据库</h2><p>SQLite的 DETACH DTABASE 语句是用来把命名数据库从一个数据库连接分离和游离出来，连接是之前使用 ATTACH 语句附加的。如果同一个数据库文件已经被附加上多个别名，DETACH 命令将只断开给定名称的连接，而其余的仍然有效。您无法分离 main 或 temp 数据库。</p>
<ul>
<li>如果数据库是在内存中或者是临时数据库，则该数据库将被摧毁，且内容将会丢失。</li>
</ul>
<h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><p>SQLite 的 DETACH DATABASE ‘Alias-Name’ 语句的基本语法如下：</p>
<p><strong>DETACH DATABASE ‘Alias-Name’;</strong></p>
<p>在这里，’Alias-Name’ 与您之前使用 ATTACH 语句附加数据库时所用到的别名相同。</p>
<h2 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h2><p>假设在前面的章节中您已经创建了一个数据库，并给它附加了 ‘test’ 和 ‘currentDB’，使用 .database 命令，我们可以看到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.databases</span><br><span class="line">seq  name             file</span><br><span class="line">---  ---------------  ----------------------</span><br><span class="line">0    main             /home/sqlite/testDB.db</span><br><span class="line">2    test             /home/sqlite/testDB.db</span><br><span class="line">3    currentDB        /home/sqlite/testDB.db</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们尝试把 ‘currentDB’ 从 testDB.db 中分离出来，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; DETACH DATABASE &apos;currentDB&apos;;</span><br></pre></td></tr></table></figure></p>
<p>现在，如果检查当前附加的数据库，您会发现，testDB.db 仍与 ‘test’ 和 ‘main’ 保持连接。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.databases</span><br><span class="line">seq  name             file</span><br><span class="line">---  ---------------  ----------------------</span><br><span class="line">0    main             /home/sqlite/testDB.db</span><br><span class="line">2    test             /home/sqlite/testDB.db</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-8"><a href="#Chapter-8" class="headerlink" title="Chapter 8"></a>Chapter 8</h1><h2 id="SQLite-创建表"><a href="#SQLite-创建表" class="headerlink" title="SQLite 创建表"></a>SQLite 创建表</h2><p>SQLite 的 <strong>CREATE TABLE</strong> 语句用于在任何给定的数据库创建一个新表。创建基本表，涉及到命名表、定义列及每一列的数据类型。</p>
<h2 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h2><p>CREATE TABLE 语句的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE database_name.table_name(</span><br><span class="line">   column1 datatype  PRIMARY KEY(one or more columns),</span><br><span class="line">   column2 datatype,</span><br><span class="line">   column3 datatype,</span><br><span class="line">   .....</span><br><span class="line">   columnN datatype,</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE 是告诉数据库系统创建一个新表的关键字。CREATE TABLE 语句后跟着表的唯一的名称或标识。您也可以选择指定带有 table_name 的 database_name。</p>
<h2 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h2><p>下面是一个实例，它创建了一个 COMPANY 表，ID 作为主键，NOT NULL 的约束表示在表中创建纪录时这些字段不能为 NULL：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>让我们再创建一个表，我们将在随后章节的练习中使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE DEPARTMENT(</span><br><span class="line">   ID INT PRIMARY KEY      NOT NULL,</span><br><span class="line">   DEPT           CHAR(50) NOT NULL,</span><br><span class="line">   EMP_ID         INT      NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 SQLIte 命令中的 .tables 命令来验证表是否已成功创建，该命令用于列出附加数据库中的所有表。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.tables</span><br><span class="line">COMPANY     DEPARTMENT</span><br></pre></td></tr></table></figure></p>
<p>在这里，可以看到我们刚创建的两张表 COMPANY、 DEPARTMENT。</p>
<p>您可以使用 SQLite .schema 命令得到表的完整信息，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.schema COMPANY</span><br><span class="line">CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-9"><a href="#Chapter-9" class="headerlink" title="Chapter 9"></a>Chapter 9</h1><h2 id="SQLite-删除表"><a href="#SQLite-删除表" class="headerlink" title="SQLite 删除表"></a>SQLite 删除表</h2><p>SQLite 的 DROP TABLE 语句用来删除表定义及其所有相关数据、索引、触发器、约束和该表的权限规范。</p>
<p><strong>使用此命令时要特别注意，因为一旦一个表被删除，表中所有信息也将永远丢失。</strong></p>
<h2 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h2><p>DROP TABLE 语句的基本语法如下。您可以选择指定带有表名的数据库名称，如下所示：</p>
<p><strong>DROP TABLE database_name.table_name;</strong></p>
<h2 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h2><p>让我们先确认 COMPANY 表已经存在，然后我们将其从数据库中删除。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.tables</span><br><span class="line">COMPANY       test.COMPANY</span><br></pre></td></tr></table></figure></p>
<p>这意味着 COMPANY 表已存在数据库中，接下来让我们把它从数据库中删除，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;DROP TABLE COMPANY;</span><br><span class="line">sqlite&gt;</span><br></pre></td></tr></table></figure></p>
<p>现在，如果尝试 .TABLES 命令，那么将无法找到 COMPANY 表了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.tables</span><br><span class="line">sqlite&gt;</span><br></pre></td></tr></table></figure></p>
<p>显示结果为空，意味着已经成功从数据库删除表。</p>
<h1 id="Chapter-10"><a href="#Chapter-10" class="headerlink" title="Chapter 10"></a>Chapter 10</h1><h2 id="SQLite-Insert-语句"><a href="#SQLite-Insert-语句" class="headerlink" title="SQLite Insert 语句"></a>SQLite Insert 语句</h2><p>SQLite 的 INSERT INTO 语句用于<strong>向数据库的某个表中添加新的数据行</strong>。</p>
<h2 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h2><p>INSERT INTO 语句有两种基本语法，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO TABLE_NAME [(column1, column2, column3,...columnN)]  </span><br><span class="line">VALUES (value1, value2, value3,...valueN);</span><br></pre></td></tr></table></figure></p>
<p>在这里，column1, column2,…columnN 是要插入数据的表中的列的名称。</p>
<p>如果要为表中的所有列添加值，您也可以不需要在 SQLite 查询中指定列名称。但要确保值的顺序与列在表中的顺序一致。SQLite 的 INSERT INTO 语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO TABLE_NAME VALUES (value1,value2,value3,...valueN);</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-5"><a href="#实例-5" class="headerlink" title="实例"></a>实例</h2><p>假设您已经在 testDB.db 中创建了 COMPANY表，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>现在，下面的语句将在 COMPANY 表中创建六个记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (1, &apos;Paul&apos;, 32, &apos;California&apos;, 20000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (2, &apos;Allen&apos;, 25, &apos;Texas&apos;, 15000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (3, &apos;Teddy&apos;, 23, &apos;Norway&apos;, 20000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (4, &apos;Mark&apos;, 25, &apos;Rich-Mond &apos;, 65000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (5, &apos;David&apos;, 27, &apos;Texas&apos;, 85000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (6, &apos;Kim&apos;, 22, &apos;South-Hall&apos;, 45000.00 );</span><br></pre></td></tr></table></figure></p>
<p>也可以使用第二种语法在 COMPANY 表中创建一个记录，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO COMPANY VALUES (7, &apos;James&apos;, 24, &apos;Houston&apos;, 10000.00 );</span><br></pre></td></tr></table></figure></p>
<p>上面的所有语句将在 COMPANY 表中创建下列记录。下一章会教您如何从一个表中显示所有这些记录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="使用一个表来填充另一个表"><a href="#使用一个表来填充另一个表" class="headerlink" title="使用一个表来填充另一个表"></a>使用一个表来填充另一个表</h2><p>可以通过在一个有一组字段的表上使用 <strong>select</strong> 语句，填充数据到另一个表中。下面是语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO first_table_name [(column1, column2, ... columnN)] </span><br><span class="line">   SELECT column1, column2, ...columnN </span><br><span class="line">   FROM second_table_name</span><br><span class="line">   [WHERE condition];</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-11"><a href="#Chapter-11" class="headerlink" title="Chapter 11"></a>Chapter 11</h1><h2 id="SQLite-Select-语句"><a href="#SQLite-Select-语句" class="headerlink" title="SQLite Select 语句"></a>SQLite Select 语句</h2><p>SQLite 的 SELECT 语句用于从 SQLite 数据库表中获取数据，以结果表的形式返回数据。这些结果表也被称为结果集。</p>
<h2 id="语法-5"><a href="#语法-5" class="headerlink" title="语法"></a>语法</h2><p>SQLite 的 SELECT 语句的基本语法如下：</p>
<p><strong>SELECT column1, column2, columnN FROM table_name;</strong><br>在这里，column1, column2…是表的字段，他们的值即是您要获取的。如果您想获取所有可用的字段，那么可以使用下面的语法：</p>
<p><strong>SELECT * FROM table_name;</strong></p>
<h2 id="实例-6"><a href="#实例-6" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，使用 SELECT 语句获取并显示所有这些记录。在这里，前三个命令被用来设置正确格式化的输出。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.header on</span><br><span class="line">sqlite&gt;.mode column</span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY;</span><br></pre></td></tr></table></figure></p>
<p>最后，将得到以下的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>如果只想获取 COMPANY 表中指定的字段，则使用下面的查询：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT ID, NAME, SALARY FROM COMPANY;</span><br></pre></td></tr></table></figure></p>
<p>上面的查询会产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        SALARY</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           Paul        20000.0</span><br><span class="line">2           Allen       15000.0</span><br><span class="line">3           Teddy       20000.0</span><br><span class="line">4           Mark        65000.0</span><br><span class="line">5           David       85000.0</span><br><span class="line">6           Kim         45000.0</span><br><span class="line">7           James       10000.0</span><br></pre></td></tr></table></figure></p>
<p>设置输出列的宽度<br>有时，由于要显示的列的默认宽度导致 .mode column，这种情况下，输出被截断。此时，您可以使用 .width num, num…. 命令设置显示列的宽度，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.width 10, 20, 10</span><br><span class="line">sqlite&gt;SELECT * FROM COMPANY;</span><br></pre></td></tr></table></figure></p>
<p>上面的 .width 命令设置第一列的宽度为 10，第二列的宽度为 20，第三列的宽度为 10。因此上述 SELECT 语句将得到以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME                  AGE         ADDRESS     SALARY</span><br><span class="line">----------  --------------------  ----------  ----------  ----------</span><br><span class="line">1           Paul                  32          California  20000.0</span><br><span class="line">2           Allen                 25          Texas       15000.0</span><br><span class="line">3           Teddy                 23          Norway      20000.0</span><br><span class="line">4           Mark                  25          Rich-Mond   65000.0</span><br><span class="line">5           David                 27          Texas       85000.0</span><br><span class="line">6           Kim                   22          South-Hall  45000.0</span><br><span class="line">7           James                 24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="Schema-信息"><a href="#Schema-信息" class="headerlink" title="Schema 信息"></a>Schema 信息</h2><p>因为所有的点命令只在 SQLite 提示符中可用，所以当您进行带有 SQLite 的编程时，您要使用下面的带有 sqlite_master 表的 SELECT 语句来列出所有在数据库中创建的表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT tbl_name FROM sqlite_master WHERE type = &apos;table&apos;;</span><br></pre></td></tr></table></figure></p>
<p>假设在 testDB.db 中已经存在唯一的 COMPANY 表，则将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tbl_name</span><br><span class="line">----------</span><br><span class="line">COMPANY</span><br></pre></td></tr></table></figure></p>
<p>您可以列出关于 COMPANY 表的完整信息，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT sql FROM sqlite_master WHERE type = &apos;table&apos; AND tbl_name = &apos;COMPANY&apos;;</span><br></pre></td></tr></table></figure></p>
<p>假设在 testDB.db 中已经存在唯一的 COMPANY 表，则将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-12"><a href="#Chapter-12" class="headerlink" title="Chapter 12"></a>Chapter 12</h1><h2 id="SQLite-运算符"><a href="#SQLite-运算符" class="headerlink" title="SQLite 运算符"></a>SQLite 运算符</h2><h2 id="SQLite-运算符是什么？"><a href="#SQLite-运算符是什么？" class="headerlink" title="SQLite 运算符是什么？"></a>SQLite 运算符是什么？</h2><p>运算符是一个<strong>保留字或字符</strong>，主要用于 SQLite 语句的 <strong>WHERE</strong> 子句中执行操作，如<strong>比较和算术运算</strong>。</p>
<p><strong>运算符用于指定 SQLite 语句中的条件</strong>，并在语句中<strong>连接多个条件</strong>。</p>
<p><strong>1. 算术运算符</strong><br><strong>2. 比较运算符</strong><br><strong>3. 逻辑运算符</strong><br><strong>4. 位运算符</strong></p>
<h2 id="SQLite-算术运算符"><a href="#SQLite-算术运算符" class="headerlink" title="SQLite 算术运算符"></a>SQLite 算术运算符</h2><ol>
<li>“+”    加法  把运算符两边的值相加    a + b 将得到 30</li>
<li>“-”    减法  左操作数减去右操作数    a - b 将得到 -10</li>
<li>“<em>”    乘法  把运算符两边的值相乘    a </em> b 将得到 200</li>
<li>“/”    除法  左操作数除以右操作数    b / a 将得到 2</li>
<li>“%”    取模  左操作数除以右操作数后得到的余数    b % a will give 0</li>
</ol>
<h2 id="实例-7"><a href="#实例-7" class="headerlink" title="实例"></a>实例</h2><p>下面是 SQLite 算术运算符的简单实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode line</span><br><span class="line">sqlite&gt; select 10 + 20;</span><br><span class="line">10 + 20 = 30</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlite&gt; select 10 - 20;</span><br><span class="line">10 - 20 = -10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlite&gt; select 10 * 20;</span><br><span class="line">10 * 20 = 200</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlite&gt; select 10 / 5;</span><br><span class="line">10 / 5 = 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlite&gt; select 12 %  5;</span><br><span class="line">12 %  5 = 2</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-比较运算符"><a href="#SQLite-比较运算符" class="headerlink" title="SQLite 比较运算符"></a>SQLite 比较运算符</h2><ol>
<li><strong>==</strong>    检查两个操作数的值是否相等，如果相等则条件为真。    (a == b) 不为真。</li>
<li><strong>=</strong>    检查两个操作数的值是否相等，如果相等则条件为真。    (a = b) 不为真。</li>
<li><strong>!=</strong>    检查两个操作数的值是否相等，如果不相等则条件为真。    (a != b) 为真。</li>
<li><strong>&lt;&gt;</strong>    检查两个操作数的值是否相等，如果不相等则条件为真。    (a &lt;&gt; b) 为真。</li>
<li><strong>&gt;</strong>    检查左操作数的值是否大于右操作数的值，如果是则条件为真。    (a &gt; b) 不为真。</li>
<li><strong>&lt;</strong>    检查左操作数的值是否小于右操作数的值，如果是则条件为真。    (a &lt; b) 为真。</li>
<li><strong>&gt;=</strong>    检查左操作数的值是否大于等于右操作数的值，如果是则条件为真。    (a &gt;= b) 不为真。</li>
<li><strong>&lt;=</strong>    检查左操作数的值是否小于等于右操作数的值，如果是则条件为真。    (a &lt;= b) 为真。</li>
<li><strong>!&lt;</strong>    检查左操作数的值是否不小于右操作数的值，如果是则条件为真。    (a !&lt; b) 为假。</li>
<li><strong>!&gt;</strong>    检查左操作数的值是否不大于右操作数的值，如果是则条件为真。    (a !&gt; b) 为真。</li>
</ol>
<h2 id="实例-8"><a href="#实例-8" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的实例演示了各种 SQLite 比较运算符的用法。</p>
<p>WHERE 子句是用来设置 SELECT 语句的条件语句。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">下面的 SELECT 语句列出了 SALARY 大于 50,000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &gt; 50000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 SALARY 等于 20,000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt;  SELECT * FROM COMPANY WHERE SALARY = 20000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">下面的 SELECT 语句列出了 SALARY 不等于 20,000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt;  SELECT * FROM COMPANY WHERE SALARY != 20000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 SALARY 不等于 20,000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &lt;&gt; 20000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 SALARY 大于等于 65,000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-逻辑运算符"><a href="#SQLite-逻辑运算符" class="headerlink" title="SQLite 逻辑运算符"></a>SQLite 逻辑运算符</h2><ol>
<li>AND    AND 运算符允许在一个 SQL 语句的 WHERE 子句中的多个条件的存在。</li>
<li>BETWEEN    BETWEEN 运算符用于在给定最小值和最大值范围内的一系列值中搜索值。</li>
<li>EXISTS    EXISTS 运算符用于在满足一定条件的指定表中搜索行的存在。</li>
<li>IN    IN 运算符用于把某个值与一系列指定列表的值进行比较。</li>
<li>NOT IN    IN 运算符的对立面，用于把某个值与不在一系列指定列表的值进行比较。</li>
<li>LIKE    LIKE 运算符用于把某个值与使用通配符运算符的相似值进行比较。</li>
<li>GLOB    GLOB 运算符用于把某个值与使用通配符运算符的相似值进行比较。GLOB 与 LIKE 不同之处在于，它是大小写敏感的。</li>
<li>NOT    NOT 运算符是所用的逻辑运算符的对立面。比如 NOT EXISTS、NOT BETWEEN、NOT IN，等等。它是否定运算符。</li>
<li>OR    OR 运算符用于结合一个 SQL 语句的 WHERE 子句中的多个条件。</li>
<li>IS NULL    NULL 运算符用于把某个值与 NULL 值进行比较。</li>
<li>IS    IS 运算符与 = 相似。</li>
<li>IS NOT    IS NOT 运算符与 != 相似。</li>
<li>||    连接两个不同的字符串，得到一个新的字符串。</li>
<li>UNIQUE    UNIQUE 运算符搜索指定表中的每一行，确保唯一性（无重复）。</li>
</ol>
<h2 id="实例-9"><a href="#实例-9" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的实例演示了 SQLite 逻辑运算符的用法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">下面的 SELECT 语句列出了 AGE 大于等于 25 且工资大于等于 65000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 AND SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 大于等于 25 或工资大于等于 65000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 OR SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 不为 NULL 的所有记录，结果显示所有的记录，意味着没有一个记录的 AGE 等于 NULL：</span><br><span class="line"></span><br><span class="line">sqlite&gt;  SELECT * FROM COMPANY WHERE AGE IS NOT NULL;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 NAME 以 &apos;Ki&apos; 开始的所有记录，&apos;Ki&apos; 之后的字符不做限制：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE NAME LIKE &apos;Ki%&apos;;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">下面的 SELECT 语句列出了 NAME 以 &apos;Ki&apos; 开始的所有记录，&apos;Ki&apos; 之后的字符不做限制：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE NAME GLOB &apos;Ki*&apos;;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值为 25 或 27 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE IN ( 25, 27 );</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值既不是 25 也不是 27 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE NOT IN ( 25, 27 );</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值在 25 与 27 之间的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE BETWEEN 25 AND 27;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句使用 SQL 子查询，子查询查找 SALARY &gt; 65000 的带有 AGE 字段的所有记录，后边的 WHERE 子句与 EXISTS 运算符一起使用，列出了外查询中的 AGE 存在于子查询返回的结果中的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT AGE FROM COMPANY </span><br><span class="line">        WHERE EXISTS (SELECT AGE FROM COMPANY WHERE SALARY &gt; 65000);</span><br><span class="line">AGE</span><br><span class="line">----------</span><br><span class="line">32</span><br><span class="line">25</span><br><span class="line">23</span><br><span class="line">25</span><br><span class="line">27</span><br><span class="line">22</span><br><span class="line">24</span><br><span class="line">下面的 SELECT 语句使用 SQL 子查询，子查询查找 SALARY &gt; 65000 的带有 AGE 字段的所有记录，后边的 WHERE 子句与 &gt; 运算符一起使用，列出了外查询中的 AGE 大于子查询返回的结果中的年龄的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY </span><br><span class="line">        WHERE AGE &gt; (SELECT AGE FROM COMPANY WHERE SALARY &gt; 65000);</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-位运算符"><a href="#SQLite-位运算符" class="headerlink" title="SQLite 位运算符"></a>SQLite 位运算符</h2><p>位运算符作用于位，并逐位执行操作。</p>
<h2 id="实例-10"><a href="#实例-10" class="headerlink" title="实例"></a>实例</h2><p>下面的实例演示了 SQLite 位运算符的用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode line</span><br><span class="line">sqlite&gt; select 60 | 13;</span><br><span class="line">60 | 13 = 61</span><br><span class="line"></span><br><span class="line">sqlite&gt; select 60 &amp; 13;</span><br><span class="line">60 &amp; 13 = 12</span><br><span class="line"></span><br><span class="line">sqlite&gt;  select  (~60);</span><br><span class="line">(~60) = -61</span><br><span class="line"></span><br><span class="line">sqlite&gt;  select  (60 &lt;&lt; 2);</span><br><span class="line">(60 &lt;&lt; 2) = 240</span><br><span class="line"></span><br><span class="line">sqlite&gt;  select  (60 &gt;&gt; 2);</span><br><span class="line">(60 &gt;&gt; 2) = 15</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-13"><a href="#Chapter-13" class="headerlink" title="Chapter 13"></a>Chapter 13</h1><h2 id="SQLite-表达式"><a href="#SQLite-表达式" class="headerlink" title="SQLite 表达式"></a>SQLite 表达式</h2><p>表达式是一个或多个值、运算符和计算值的SQL函数的组合。</p>
<p>SQL 表达式与公式类似，都写在查询语言中。</p>
<h2 id="语法-6"><a href="#语法-6" class="headerlink" title="语法"></a>语法</h2><p>假设 SELECT 语句的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name </span><br><span class="line">WHERE [CONDITION | EXPRESSION];</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-布尔表达式"><a href="#SQLite-布尔表达式" class="headerlink" title="SQLite - 布尔表达式"></a>SQLite - 布尔表达式</h2><p>SQLite 的布尔表达式在匹配单个值的基础上获取数据。语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name </span><br><span class="line">WHERE SINGLE VALUE MATCHING EXPRESSION;</span><br></pre></td></tr></table></figure></p>
<p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的实例演示了 SQLite 布尔表达式的用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE SALARY = 10000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           James        24          Houston   10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-数值表达式"><a href="#SQLite-数值表达式" class="headerlink" title="SQLite - 数值表达式"></a>SQLite - 数值表达式</h2><h2 id="这些表达式用来执行查询中的任何数学运算。语法如下："><a href="#这些表达式用来执行查询中的任何数学运算。语法如下：" class="headerlink" title="这些表达式用来执行查询中的任何数学运算。语法如下："></a>这些表达式用来执行查询中的任何数学运算。语法如下：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT numerical_expression as  OPERATION_NAME</span><br><span class="line">[FROM table_name WHERE CONDITION] ;</span><br></pre></td></tr></table></figure>
<p>在这里，numerical_expression 用于数学表达式或任何公式。下面的实例演示了 SQLite 数值表达式的用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT (15 + 6) AS ADDITION</span><br><span class="line">ADDITION = 21</span><br></pre></td></tr></table></figure></p>
<p>有几个内置的函数，比如 avg()、sum()、count()，等等，执行被称为对一个表或一个特定的表列的汇总数据计算。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT COUNT(*) AS &quot;RECORDS&quot; FROM COMPANY; </span><br><span class="line">RECORDS = 7</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-日期表达式"><a href="#SQLite-日期表达式" class="headerlink" title="SQLite - 日期表达式"></a>SQLite - 日期表达式</h2><p>日期表达式返回当前系统日期和时间值，这些表达式将被用于各种数据操作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT CURRENT_TIMESTAMP;</span><br><span class="line">2019-05-10 14:07:56</span><br></pre></td></tr></table></figure></p>
<p>current_timestamp 得到的时间，时区不对，要想得到本地时间，试试下面这个：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select datetime(&apos;now&apos;,&apos;localtime&apos;);</span><br><span class="line">2019-05-10 22:10:44</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-14"><a href="#Chapter-14" class="headerlink" title="Chapter 14"></a>Chapter 14</h1><h2 id="SQLite-Where-子句"><a href="#SQLite-Where-子句" class="headerlink" title="SQLite Where 子句"></a>SQLite Where 子句</h2><p>SQLite的 WHERE 子句用于指定从一个表或多个表中获取数据的条件。</p>
<p>如果满足给定的条件，即为真（true）时，则从表中返回特定的值。您可以使用 WHERE 子句来过滤记录，只获取需要的记录。</p>
<p>WHERE 子句不仅可用在 SELECT 语句中，它也可用在 UPDATE、DELETE 语句中，等等</p>
<h2 id="语法-7"><a href="#语法-7" class="headerlink" title="语法"></a>语法</h2><p>SQLite 的带有 WHERE 子句的 SELECT 语句的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition]</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-11"><a href="#实例-11" class="headerlink" title="实例"></a>实例</h2><p>您还可以使用比较或逻辑运算符指定条件，比如 &gt;、&lt;、=、LIKE、NOT，等等。假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的实例演示了 SQLite 逻辑运算符的用法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">下面的 SELECT 语句列出了 AGE 大于等于 25 且工资大于等于 65000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 AND SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 大于等于 25 或工资大于等于 65000.00 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 OR SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 不为 NULL 的所有记录，结果显示所有的记录，意味着没有一个记录的 AGE 等于 NULL：</span><br><span class="line"></span><br><span class="line">sqlite&gt;  SELECT * FROM COMPANY WHERE AGE IS NOT NULL;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 NAME 以 &apos;Ki&apos; 开始的所有记录，&apos;Ki&apos; 之后的字符不做限制：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE NAME LIKE &apos;Ki%&apos;;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">下面的 SELECT 语句列出了 NAME 以 &apos;Ki&apos; 开始的所有记录，&apos;Ki&apos; 之后的字符不做限制：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE NAME GLOB &apos;Ki*&apos;;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值为 25 或 27 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE IN ( 25, 27 );</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值既不是 25 也不是 27 的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE NOT IN ( 25, 27 );</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">下面的 SELECT 语句列出了 AGE 的值在 25 与 27 之间的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE BETWEEN 25 AND 27;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">下面的 SELECT 语句使用 SQL 子查询，子查询查找 SALARY &gt; 65000 的带有 AGE 字段的所有记录，后边的 WHERE 子句与 EXISTS 运算符一起使用，列出了外查询中的 AGE 存在于子查询返回的结果中的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT AGE FROM COMPANY </span><br><span class="line">        WHERE EXISTS (SELECT AGE FROM COMPANY WHERE SALARY &gt; 65000);</span><br><span class="line">AGE</span><br><span class="line">----------</span><br><span class="line">32</span><br><span class="line">25</span><br><span class="line">23</span><br><span class="line">25</span><br><span class="line">27</span><br><span class="line">22</span><br><span class="line">24</span><br><span class="line">下面的 SELECT 语句使用 SQL 子查询，子查询查找 SALARY &gt; 65000 的带有 AGE 字段的所有记录，后边的 WHERE 子句与 &gt; 运算符一起使用，列出了外查询中的 AGE 大于子查询返回的结果中的年龄的所有记录：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT * FROM COMPANY </span><br><span class="line">        WHERE AGE &gt; (SELECT AGE FROM COMPANY WHERE SALARY &gt; 65000);</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-15"><a href="#Chapter-15" class="headerlink" title="Chapter 15"></a>Chapter 15</h1><h2 id="SQLite-AND-OR-运算符"><a href="#SQLite-AND-OR-运算符" class="headerlink" title="SQLite AND/OR 运算符"></a>SQLite AND/OR 运算符</h2><p>SQLite 的 AND 和 OR 运算符用于编译多个条件来缩小在 SQLite 语句中所选的数据。这两个运算符被称为连接运算符。</p>
<p>这些运算符为同一个 SQLite 语句中不同的运算符之间的多个比较提供了可能。</p>
<h2 id="AND-运算符"><a href="#AND-运算符" class="headerlink" title="AND 运算符"></a>AND 运算符</h2><p>AND 运算符允许在一个 SQL 语句的 WHERE 子句中的多个条件的存在。使用 AND 运算符时，只有当所有条件都为真（true）时，整个条件为真（true）。例如，只有当 condition1 和 condition2 都为真（true）时，[condition1] AND [condition2] 为真（true）。</p>
<h2 id="语法-8"><a href="#语法-8" class="headerlink" title="语法"></a>语法</h2><p>带有 WHERE 子句的 AND 运算符的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition1] AND [condition2]...AND [conditionN];</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 AND 运算符来结合 N 个数量的条件。SQLite 语句需要执行的动作是，无论是事务或查询，所有由 AND 分隔的条件都必须为真（TRUE）。</p>
<h2 id="实例-12"><a href="#实例-12" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的 SELECT 语句列出了 AGE 大于等于 25 且工资大于等于 65000.00 的所有记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 AND SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="OR-运算符"><a href="#OR-运算符" class="headerlink" title="OR 运算符"></a>OR 运算符</h2><p>OR 运算符也用于结合一个 SQL 语句的 WHERE 子句中的多个条件。使用 OR 运算符时，只要当条件中任何一个为真（true）时，整个条件为真（true）。例如，只要当 condition1 或 condition2 有一个为真（true）时，[condition1] OR [condition2] 为真（true）。</p>
<h2 id="语法-9"><a href="#语法-9" class="headerlink" title="语法"></a>语法</h2><p>带有 WHERE 子句的 OR 运算符的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition1] OR [condition2]...OR [conditionN]</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 OR 运算符来结合 N 个数量的条件。SQLite 语句需要执行的动作是，无论是事务或查询，只要任何一个由 OR 分隔的条件为真（TRUE）即可。</p>
<h2 id="实例-13"><a href="#实例-13" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面的 SELECT 语句列出了 AGE 大于等于 25 或工资大于等于 65000.00 的所有记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 OR SALARY &gt;= 65000;</span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-16"><a href="#Chapter-16" class="headerlink" title="Chapter 16"></a>Chapter 16</h1><h2 id="SQLite-Update-语句"><a href="#SQLite-Update-语句" class="headerlink" title="SQLite Update 语句"></a>SQLite Update 语句</h2><p>SQLite 的 UPDATE 查询用于<strong>修改表中已有的记录</strong>。可以使用带有 <strong>WHERE</strong> 子句的 <strong>UPDATE</strong> 查询来更新选定行，否则所有的行都会被更新。</p>
<h2 id="语法-10"><a href="#语法-10" class="headerlink" title="语法"></a>语法</h2><p>带有 WHERE 子句的 UPDATE 查询的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table_name</span><br><span class="line">SET column1 = value1, column2 = value2...., columnN = valueN</span><br><span class="line">WHERE [condition];</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 AND 或 OR 运算符来结合 N 个数量的条件。</p>
<h2 id="实例-14"><a href="#实例-14" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它会更新 ID 为 6 的客户地址：</p>
<p>sqlite&gt; UPDATE COMPANY SET ADDRESS = ‘Texas’ WHERE ID = 6;<br>现在，COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          Texas       45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>如果您想修改 COMPANY 表中 ADDRESS 和 SALARY 列的所有值，则不需要使用 WHERE 子句，UPDATE 查询如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; UPDATE COMPANY SET ADDRESS = &apos;Texas&apos;, SALARY = 20000.00;</span><br></pre></td></tr></table></figure></p>
<p>现在，COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          Texas       20000.0</span><br><span class="line">2           Allen       25          Texas       20000.0</span><br><span class="line">3           Teddy       23          Texas       20000.0</span><br><span class="line">4           Mark        25          Texas       20000.0</span><br><span class="line">5           David       27          Texas       20000.0</span><br><span class="line">6           Kim         22          Texas       20000.0</span><br><span class="line">7           James       24          Texas       20000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-17"><a href="#Chapter-17" class="headerlink" title="Chapter 17"></a>Chapter 17</h1><h2 id="SQLite-Delete-语句"><a href="#SQLite-Delete-语句" class="headerlink" title="SQLite Delete 语句"></a>SQLite Delete 语句</h2><p>SQLite 的 DELETE 查询用于<strong>删除表中已有的记录</strong>。可以使用带有 WHERE 子句的 DELETE 查询来删除选定行，否则所有的记录都会被删除。</p>
<h2 id="语法-11"><a href="#语法-11" class="headerlink" title="语法"></a>语法</h2><p>带有 WHERE 子句的 DELETE 查询的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM table_name</span><br><span class="line">WHERE [condition];</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 AND 或 OR 运算符来结合 N 个数量的条件。</p>
<h2 id="实例-15"><a href="#实例-15" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它会删除 ID 为 7 的客户：</p>
<p><code>sqlite&gt; DELETE FROM COMPANY WHERE ID = 7;</code><br>现在，COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br></pre></td></tr></table></figure></p>
<p>如果您想要从 COMPANY 表中删除所有记录，则不需要使用 WHERE 子句，DELETE 查询如下：</p>
<p><code>sqlite&gt; DELETE FROM COMPANY;</code><br>现在，COMPANY 表中没有任何的记录，因为所有的记录已经通过 DELETE 语句删除。</p>
<h1 id="Chapter-18"><a href="#Chapter-18" class="headerlink" title="Chapter 18"></a>Chapter 18</h1><h2 id="SQLite-Like-子句"><a href="#SQLite-Like-子句" class="headerlink" title="SQLite Like 子句"></a>SQLite Like 子句</h2><p>SQLite 的 LIKE 运算符是用来匹配通配符指定模式的文本值。如果搜索表达式与模式表达式匹配，LIKE 运算符将返回真（true），也就是 1。这里有两个通配符与 LIKE 运算符一起使用：</p>
<ul>
<li><p>百分号 （%）</p>
</li>
<li><p>下划线 （_）</p>
</li>
<li><p>百分号（%）代表零个、一个或多个数字或字符。下划线（_）代表一个单一的数字或字符。这些符号可以被组合使用。</p>
</li>
</ul>
<h2 id="语法-12"><a href="#语法-12" class="headerlink" title="语法"></a>语法</h2><p>% 和 _ 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_list </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column LIKE &apos;XXXX%&apos;</span><br><span class="line"></span><br><span class="line">or </span><br><span class="line"></span><br><span class="line">SELECT column_list </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column LIKE &apos;%XXXX%&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT column_list </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column LIKE &apos;XXXX_&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT column_list </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column LIKE &apos;_XXXX&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT column_list </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column LIKE &apos;_XXXX_&apos;</span><br></pre></td></tr></table></figure></p>
<p>您可以使用 AND 或 OR 运算符来结合 N 个数量的条件。在这里，XXXX 可以是任何数字或字符串值。</p>
<h2 id="实例-16"><a href="#实例-16" class="headerlink" title="实例"></a>实例</h2><p>下面一些实例演示了 带有 ‘%’ 和 ‘_’ 运算符的 LIKE 子句不同的地方：</p>
<ol>
<li>语句    描述</li>
<li>WHERE SALARY LIKE ‘200%’    查找以 200 开头的任意值</li>
<li>WHERE SALARY LIKE ‘%200%’    查找任意位置包含 200 的任意值</li>
<li>WHERE SALARY LIKE ‘_00%’    查找第二位和第三位为 00 的任意值</li>
<li>WHERE SALARY LIKE ‘2_%_%’    查找以 2 开头，且长度至少为 3 个字符的任意值</li>
<li>WHERE SALARY LIKE ‘%2’    查找以 2 结尾的任意值</li>
<li>WHERE SALARY LIKE ‘_2%3’    查找第二位为 2，且以 3 结尾的任意值</li>
<li>WHERE SALARY LIKE ‘2___3’    查找长度为 5 位数，且以 2 开头以 3 结尾的任意值</li>
</ol>
<p>让我们举一个实际的例子，假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它显示 COMPANY 表中 AGE 以 2 开头的所有记录：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY WHERE AGE  LIKE &#39;2%&#39;;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它显示 COMPANY 表中 ADDRESS 文本里包含一个连字符（-）的所有记录：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY WHERE ADDRESS  LIKE &#39;%-%&#39;;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-19"><a href="#Chapter-19" class="headerlink" title="Chapter 19"></a>Chapter 19</h1><h2 id="SQLite-Glob-子句"><a href="#SQLite-Glob-子句" class="headerlink" title="SQLite Glob 子句"></a>SQLite Glob 子句</h2><p>SQLite 的 GLOB 运算符是用来匹配通配符指定模式的文本值。如果搜索表达式与模式表达式匹配，GLOB 运算符将返回真（true），也就是 1。与 LIKE 运算符不同的是，GLOB 是大小写敏感的，对于下面的通配符，它遵循 UNIX 的语法。</p>
<ul>
<li><p>星号 （*）</p>
</li>
<li><p>问号 （?）</p>
</li>
<li><p>星号（*）代表零个、一个或多个数字或字符。问号（?）代表一个单一的数字或字符。这些符号可以被组合使用。</p>
</li>
</ul>
<h2 id="语法-13"><a href="#语法-13" class="headerlink" title="语法"></a>语法</h2><ul>
<li>和 ? 的基本语法如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;XXXX*&apos;</span><br><span class="line"></span><br><span class="line">or </span><br><span class="line"></span><br><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;*XXXX*&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;XXXX?&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;?XXXX&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;?XXXX?&apos;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">SELECT FROM table_name</span><br><span class="line">WHERE column GLOB &apos;????&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>您可以使用 AND 或 OR 运算符来结合 N 个数量的条件。在这里，XXXX 可以是任何数字或字符串值。</p>
<h2 id="实例-17"><a href="#实例-17" class="headerlink" title="实例"></a>实例</h2><p>下面一些实例演示了 带有 ‘*’ 和 ‘?’ 运算符的 GLOB 子句不同的地方：</p>
<ol>
<li>语句    描述</li>
<li>WHERE SALARY GLOB ‘200*’    查找以 200 开头的任意值</li>
<li>WHERE SALARY GLOB ‘<em>200</em>‘    查找任意位置包含 200 的任意值</li>
<li>WHERE SALARY GLOB ‘?00*’    查找第二位和第三位为 00 的任意值</li>
<li>WHERE SALARY GLOB ‘2??’    查找以 2 开头，且长度至少为 3 个字符的任意值</li>
<li>WHERE SALARY GLOB ‘*2’    查找以 2 结尾的任意值</li>
<li>WHERE SALARY GLOB ‘?2*3’    查找第二位为 2，且以 3 结尾的任意值</li>
<li>WHERE SALARY GLOB ‘2???3’    查找长度为 5 位数，且以 2 开头以 3 结尾的任意值<br>让我们举一个实际的例子，假设 COMPANY 表有以下记录：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>下面是一个实例，它显示 COMPANY 表中 AGE 以 2 开头的所有记录：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY WHERE AGE  GLOB &#39;2*&#39;;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它显示 COMPANY 表中 ADDRESS 文本里包含一个连字符（-）的所有记录：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY WHERE ADDRESS  GLOB &#39;*-*&#39;;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-20"><a href="#Chapter-20" class="headerlink" title="Chapter 20"></a>Chapter 20</h1><h2 id="SQLite-Limit-子句"><a href="#SQLite-Limit-子句" class="headerlink" title="SQLite Limit 子句"></a>SQLite Limit 子句</h2><p>SQLite 的 LIMIT 子句用于限制由 SELECT 语句返回的数据数量。</p>
<h2 id="语法-14"><a href="#语法-14" class="headerlink" title="语法"></a>语法</h2><p>带有 LIMIT 子句的 SELECT 语句的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name</span><br><span class="line">LIMIT [no of rows]</span><br></pre></td></tr></table></figure></p>
<p>下面是 LIMIT 子句与 OFFSET 子句一起使用时的语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2, columnN </span><br><span class="line">FROM table_name</span><br><span class="line">LIMIT [no of rows] OFFSET [row num]</span><br></pre></td></tr></table></figure></p>
<p>SQLite 引擎将返回从下一行开始直到给定的 OFFSET 为止的所有行，如下面的最后一个实例所示。</p>
<h2 id="实例-18"><a href="#实例-18" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它限制了您想要从表中提取的行数：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY LIMIT 6;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br></pre></td></tr></table></figure></p>
<p>但是，在某些情况下，可能需要从一个特定的偏移开始提取记录。下面是一个实例，从第三位开始提取 3 个记录：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY LIMIT 3 OFFSET 2;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-21"><a href="#Chapter-21" class="headerlink" title="Chapter 21"></a>Chapter 21</h1><h2 id="SQLite-Order-By"><a href="#SQLite-Order-By" class="headerlink" title="SQLite Order By"></a>SQLite Order By</h2><p>SQLite 的 ORDER BY 子句是用来基于一个或多个列按升序或降序顺序排列数据。</p>
<h2 id="语法-15"><a href="#语法-15" class="headerlink" title="语法"></a>语法</h2><p>ORDER BY 子句的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column-list </span><br><span class="line">FROM table_name </span><br><span class="line">[WHERE condition] </span><br><span class="line">[ORDER BY column1, column2, .. columnN] [ASC | DESC];</span><br></pre></td></tr></table></figure></p>
<p>您可以在 ORDER BY 子句中使用多个列。确保您使用的排序列在列清单中。</p>
<h2 id="实例-19"><a href="#实例-19" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它会将结果按 SALARY 升序排序：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY ORDER BY SALARY ASC;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它会将结果按 NAME 和 SALARY 升序排序：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY ORDER BY NAME, SALARY ASC;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它会将结果按 NAME 降序排序：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY ORDER BY NAME DESC;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-22"><a href="#Chapter-22" class="headerlink" title="Chapter 22"></a>Chapter 22</h1><h2 id="SQLite-Group-By"><a href="#SQLite-Group-By" class="headerlink" title="SQLite Group By"></a>SQLite Group By</h2><p>SQLite 的 GROUP BY 子句用于与 SELECT 语句一起使用，来对相同的数据进行分组。</p>
<p>在 SELECT 语句中，GROUP BY 子句放在 WHERE 子句之后，放在 ORDER BY 子句之前。</p>
<h2 id="语法-16"><a href="#语法-16" class="headerlink" title="语法"></a>语法</h2><p>下面给出了 GROUP BY 子句的基本语法。GROUP BY 子句必须放在 WHERE 子句中的条件之后，必须放在 ORDER BY 子句之前。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT column-list</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [ conditions ]</span><br><span class="line">GROUP BY column1, column2....columnN</span><br><span class="line">ORDER BY column1, column2....columnN</span><br></pre></td></tr></table></figure></p>
<p>您可以在 GROUP BY 子句中使用多个列。确保您使用的分组列在列清单中。</p>
<h2 id="实例-20"><a href="#实例-20" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>如果您想了解每个客户的工资总额，则可使用 GROUP BY 查询，如下所示：</p>
<p><code>sqlite&gt; SELECT NAME, SUM(SALARY) FROM COMPANY GROUP BY NAME;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME        SUM(SALARY)</span><br><span class="line">----------  -----------</span><br><span class="line">Allen       15000.0</span><br><span class="line">David       85000.0</span><br><span class="line">James       10000.0</span><br><span class="line">Kim         45000.0</span><br><span class="line">Mark        65000.0</span><br><span class="line">Paul        20000.0</span><br><span class="line">Teddy       20000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们使用下面的 INSERT 语句在 COMPANY 表中另外创建三个记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO COMPANY VALUES (8, &apos;Paul&apos;, 24, &apos;Houston&apos;, 20000.00 );</span><br><span class="line">INSERT INTO COMPANY VALUES (9, &apos;James&apos;, 44, &apos;Norway&apos;, 5000.00 );</span><br><span class="line">INSERT INTO COMPANY VALUES (10, &apos;James&apos;, 45, &apos;Texas&apos;, 5000.00 );</span><br></pre></td></tr></table></figure></p>
<p>现在，我们的表具有重复名称的记录，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">8           Paul        24          Houston     20000.0</span><br><span class="line">9           James       44          Norway      5000.0</span><br><span class="line">10          James       45          Texas       5000.0</span><br></pre></td></tr></table></figure></p>
<p>让我们用同样的 GROUP BY 语句来对所有记录按 NAME 列进行分组，如下所示：</p>
<p><code>sqlite&gt; SELECT NAME, SUM(SALARY) FROM COMPANY GROUP BY NAME ORDER BY NAME;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME        SUM(SALARY)</span><br><span class="line">----------  -----------</span><br><span class="line">Allen       15000</span><br><span class="line">David       85000</span><br><span class="line">James       20000</span><br><span class="line">Kim         45000</span><br><span class="line">Mark        65000</span><br><span class="line">Paul        40000</span><br><span class="line">Teddy       20000</span><br></pre></td></tr></table></figure></p>
<p>让我们把 ORDER BY 子句与 GROUP BY 子句一起使用，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;  SELECT NAME, SUM(SALARY) </span><br><span class="line">         FROM COMPANY GROUP BY NAME ORDER BY NAME DESC;</span><br></pre></td></tr></table></figure></p>
<p>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME        SUM(SALARY)</span><br><span class="line">----------  -----------</span><br><span class="line">Teddy       20000</span><br><span class="line">Paul        40000</span><br><span class="line">Mark        65000</span><br><span class="line">Kim         45000</span><br><span class="line">James       20000</span><br><span class="line">David       85000</span><br><span class="line">Allen       15000</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-23"><a href="#Chapter-23" class="headerlink" title="Chapter 23"></a>Chapter 23</h1><h2 id="SQLite-Having-子句"><a href="#SQLite-Having-子句" class="headerlink" title="SQLite Having 子句"></a>SQLite Having 子句</h2><p>HAVING 子句允许指定条件来过滤将出现在最终结果中的分组结果。</p>
<p><strong>WHERE 子句在所选列上设置条件，而 HAVING 子句则在由 GROUP BY 子句创建的分组上设置条件。</strong></p>
<h2 id="语法-17"><a href="#语法-17" class="headerlink" title="语法"></a>语法</h2><p>下面是 HAVING 子句在 SELECT 查询中的位置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">FROM</span><br><span class="line">WHERE</span><br><span class="line">GROUP BY</span><br><span class="line">HAVING</span><br><span class="line">ORDER BY</span><br></pre></td></tr></table></figure></p>
<p>在一个查询中，HAVING 子句必须放在 GROUP BY 子句之后，必须放在 ORDER BY 子句之前。下面是包含 HAVING 子句的 SELECT 语句的语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2</span><br><span class="line">FROM table1, table2</span><br><span class="line">WHERE [ conditions ]</span><br><span class="line">GROUP BY column1, column2</span><br><span class="line">HAVING [ conditions ]</span><br><span class="line">ORDER BY column1, column2</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-21"><a href="#实例-21" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">8           Paul        24          Houston     20000.0</span><br><span class="line">9           James       44          Norway      5000.0</span><br><span class="line">10          James       45          Texas       5000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它将显示名称计数小于 2 的所有记录：</p>
<p><code>sqlite &gt; SELECT * FROM COMPANY GROUP BY name HAVING count(name) &lt; 2;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000</span><br><span class="line">5           David       27          Texas       85000</span><br><span class="line">6           Kim         22          South-Hall  45000</span><br><span class="line">4           Mark        25          Rich-Mond   65000</span><br><span class="line">3           Teddy       23          Norway      20000</span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例，它将显示名称计数大于 2 的所有记录：</p>
<p>sqlite &gt; SELECT * FROM COMPANY GROUP BY name HAVING count(name) &gt; 2;<br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">10          James       45          Texas       5000</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-24"><a href="#Chapter-24" class="headerlink" title="Chapter 24"></a>Chapter 24</h1><h2 id="SQLite-Distinct-关键字"><a href="#SQLite-Distinct-关键字" class="headerlink" title="SQLite Distinct 关键字"></a>SQLite Distinct 关键字</h2><p>SQLite 的 <strong>DISTINCT 关键字与 SELECT 语句一起使用，来消除所有重复的记录，并只获取唯一一次记录。</strong></p>
<p>有可能出现一种情况，在一个表中有多个重复的记录。当提取这样的记录时，DISTINCT 关键字就显得特别有意义，它只获取唯一一次记录，而不是获取重复记录。</p>
<h2 id="语法-18"><a href="#语法-18" class="headerlink" title="语法"></a>语法</h2><p>用于消除重复记录的 DISTINCT 关键字的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT column1, column2,.....columnN </span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition]</span><br></pre></td></tr></table></figure></p>
<p>实例<br>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br><span class="line">8           Paul        24          Houston     20000.0</span><br><span class="line">9           James       44          Norway      5000.0</span><br><span class="line">10          James       45          Texas       5000.0</span><br></pre></td></tr></table></figure></p>
<p>首先，让我们来看看下面的 SELECT 查询，它将返回重复的工资记录：</p>
<p><code>sqlite&gt; SELECT name FROM COMPANY;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">----------</span><br><span class="line">Paul</span><br><span class="line">Allen</span><br><span class="line">Teddy</span><br><span class="line">Mark</span><br><span class="line">David</span><br><span class="line">Kim</span><br><span class="line">James</span><br><span class="line">Paul</span><br><span class="line">James</span><br><span class="line">James</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们在上述的 SELECT 查询中使用 DISTINCT 关键字：</p>
<p><code>sqlite&gt; SELECT DISTINCT name FROM COMPANY;</code><br>这将产生以下结果，没有任何重复的条目：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">----------</span><br><span class="line">Paul</span><br><span class="line">Allen</span><br><span class="line">Teddy</span><br><span class="line">Mark</span><br><span class="line">David</span><br><span class="line">Kim</span><br><span class="line">James</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-25"><a href="#Chapter-25" class="headerlink" title="Chapter 25"></a>Chapter 25</h1><h2 id="SQLite-PRAGMA"><a href="#SQLite-PRAGMA" class="headerlink" title="SQLite PRAGMA"></a>SQLite PRAGMA</h2><p>SQLite 的 PRAGMA 命令是一个特殊的命令，可以<strong>用在 SQLite 环境内控制各种环境变量和状态标志</strong>。一个 PRAGMA 值<strong>可以被读取，也可以根据需求进行设置</strong>。</p>
<h2 id="语法-19"><a href="#语法-19" class="headerlink" title="语法"></a>语法</h2><p>要查询当前的 PRAGMA 值，只需要提供该 pragma 的名字：</p>
<p><code>PRAGMA pragma_name;</code><br>要为 PRAGMA 设置一个新的值，语法如下：</p>
<p><code>PRAGMA pragma_name = value;</code><br>设置模式，可以是名称或等值的整数，但返回的值将始终是一个整数。</p>
<h3 id="auto-vacuum-Pragma"><a href="#auto-vacuum-Pragma" class="headerlink" title="auto_vacuum Pragma"></a>auto_vacuum Pragma</h3><p>auto_vacuum Pragma 获取或设置 auto-vacuum 模式。语法如下：</p>
<ul>
<li>PRAGMA [database.]auto_vacuum;</li>
<li><p>PRAGMA [database.]auto_vacuum = mode;<br>其中，mode 可以是以下任何一种：</p>
</li>
<li><p>Pragma 值    描述</p>
</li>
<li>0 或 NONE    禁用 Auto-vacuum。这是默认模式，意味着数据库文件尺寸大小不会缩小，除非手动使用 VACUUM 命令。</li>
<li>1 或 FULL    启用 Auto-vacuum，是全自动的。在该模式下，允许数据库文件随着数据从数据库移除而缩小。</li>
<li>2 或 INCREMENTAL    启用 Auto-vacuum，但是必须手动激活。在该模式下，引用数据被维持，免费页面只放在免费列表中。这些页面可在任何时候使用 incremental_vacuum pragma 进行覆盖。</li>
<li>cache_size Pragma</li>
<li><p>cache_size Pragma 可获取或暂时设置在内存中页面缓存的最大尺寸。语法如下：</p>
</li>
<li><p>PRAGMA [database.]cache_size;</p>
</li>
<li>PRAGMA [database.]cache_size = pages;</li>
<li>pages 值表示在缓存中的页面数。内置页面缓存的默认大小为 2,000 页，最小尺寸为 10 页。</li>
</ul>
<h3 id="case-sensitive-like-Pragma"><a href="#case-sensitive-like-Pragma" class="headerlink" title="case_sensitive_like Pragma"></a>case_sensitive_like Pragma</h3><p>case_sensitive_like Pragma 控制内置的 LIKE 表达式的大小写敏感度。默认情况下，该 Pragma 为 false，这意味着，内置的 LIKE 操作符忽略字母的大小写。语法如下：</p>
<p><code>PRAGMA case_sensitive_like = [true|false];</code><br>目前没有办法查询该 Pragma 的当前状态。</p>
<h3 id="count-changes-Pragma"><a href="#count-changes-Pragma" class="headerlink" title="count_changes Pragma"></a>count_changes Pragma</h3><p>count_changes Pragma 获取或设置数据操作语句的返回值，如 INSERT、UPDATE 和 DELETE。语法如下：</p>
<ul>
<li>PRAGMA count_changes;</li>
<li>PRAGMA count_changes = [true|false];<br>默认情况下，该 Pragma 为 false，这些语句不返回任何东西。如果设置为 true，每个所提到的语句将返回一个单行单列的表，由一个单一的整数值组成，该整数表示操作影响的行。</li>
</ul>
<h3 id="database-list-Pragma"><a href="#database-list-Pragma" class="headerlink" title="database_list Pragma"></a>database_list Pragma</h3><p>database_list Pragma 将用于列出了所有的数据库连接。语法如下：</p>
<p><code>PRAGMA database_list;</code><br>该 Pragma 将返回一个单行三列的表格，每当打开或附加数据库时，会给出数据库中的序列号，它的名称和相关的文件。</p>
<h3 id="encoding-Pragma"><a href="#encoding-Pragma" class="headerlink" title="encoding Pragma"></a>encoding Pragma</h3><p>encoding Pragma 控制字符串如何编码及存储在数据库文件中。语法如下：</p>
<ul>
<li>PRAGMA encoding;</li>
<li>PRAGMA encoding = format;</li>
<li>格式值可以是 UTF-8、UTF-16le 或 UTF-16be 之一。</li>
</ul>
<h3 id="freelist-count-Pragma"><a href="#freelist-count-Pragma" class="headerlink" title="freelist_count Pragma"></a>freelist_count Pragma</h3><p>freelist_count Pragma 返回一个整数，表示当前被标记为免费和可用的数据库页数。语法如下：</p>
<p><code>PRAGMA [database.]freelist_count;</code><br>格式值可以是 UTF-8、UTF-16le 或 UTF-16be 之一。</p>
<h3 id="index-info-Pragma"><a href="#index-info-Pragma" class="headerlink" title="index_info Pragma"></a>index_info Pragma</h3><p>index_info Pragma 返回关于数据库索引的信息。语法如下：</p>
<ul>
<li>PRAGMA [database.]index_info( index_name );<br>结果集将为每个包含在给出列序列的索引、表格内的列索引、列名称的列显示一行。</li>
</ul>
<h3 id="index-list-Pragma"><a href="#index-list-Pragma" class="headerlink" title="index_list Pragma"></a>index_list Pragma</h3><p>index_list Pragma 列出所有与表相关联的索引。语法如下：</p>
<ul>
<li>PRAGMA [database.]index_list( table_name );<br>结果集将为每个给出列序列的索引、索引名称、表示索引是否唯一的标识显示一行。</li>
</ul>
<h3 id="journal-mode-Pragma"><a href="#journal-mode-Pragma" class="headerlink" title="journal_mode Pragma"></a>journal_mode Pragma</h3><p>journal_mode Pragma 获取或设置控制日志文件如何存储和处理的日志模式。语法如下：:</p>
<ul>
<li>PRAGMA journal_mode;</li>
<li>PRAGMA journal_mode = mode;</li>
<li>PRAGMA database.journal_mode;</li>
<li><p>PRAGMA database.journal_mode = mode;<br>这里支持五种日志模式：</p>
</li>
<li><p>Pragma 值    描述</p>
</li>
<li>DELETE    默认模式。在该模式下，在事务结束时，日志文件将被删除。</li>
<li>TRUNCATE    日志文件被阶段为零字节长度。</li>
<li>PERSIST    日志文件被留在原地，但头部被重写，表明日志不再有效。</li>
<li>MEMORY    日志记录保留在内存中，而不是磁盘上。</li>
<li>OFF    不保留任何日志记录。</li>
<li>max_page_count Pragma</li>
<li><p>max_page_count Pragma 为数据库获取或设置允许的最大页数。语法如下：</p>
</li>
<li><p>PRAGMA [database.]max_page_count;</p>
</li>
<li>PRAGMA [database.]max_page_count = max_page;</li>
<li>默认值是 1,073,741,823，这是一个千兆的页面，即如果默认 1 KB 的页面大小，那么数据库中增长起来的一个兆字节。</li>
</ul>
<h3 id="page-count-Pragma"><a href="#page-count-Pragma" class="headerlink" title="page_count Pragma"></a>page_count Pragma</h3><p>page_count Pragma 返回当前数据库中的网页数量。语法如下：</p>
<p><code>PRAGMA [database.]page_count;</code><br>数据库文件的大小应该是 page_count * page_size。</p>
<h3 id="page-size-Pragma"><a href="#page-size-Pragma" class="headerlink" title="page_size Pragma"></a>page_size Pragma</h3><p>page_size Pragma 获取或设置数据库页面的大小。语法如下：</p>
<ul>
<li>PRAGMA [database.]page_size;</li>
<li>PRAGMA [database.]page_size = bytes;<br>默认情况下，允许的尺寸是 512、1024、2048、4096、8192、16384、32768 字节。改变现有数据库页面大小的唯一方法就是设置页面大小，然后立即 VACUUM 该数据库。</li>
</ul>
<h3 id="parser-trace-Pragma"><a href="#parser-trace-Pragma" class="headerlink" title="parser_trace Pragma"></a>parser_trace Pragma</h3><p>parser_trace Pragma 随着它解析 SQL 命令来控制打印的调试状态，语法如下：<br><code>PRAGMA parser_trace = [true|false];</code><br>默认情况下，它被设置为 false，但设置为 true 时则启用，此时 SQL 解析器会随着它解析 SQL 命令来打印出它的状态。</p>
<h3 id="recursive-triggers-Pragma"><a href="#recursive-triggers-Pragma" class="headerlink" title="recursive_triggers Pragma"></a>recursive_triggers Pragma</h3><p>recursive_triggers Pragma 获取或设置递归触发器功能。如果未启用递归触发器，一个触发动作将不会触发另一个触发。语法如下：</p>
<ul>
<li>PRAGMA recursive_triggers;</li>
<li>PRAGMA recursive_triggers = [true|false];</li>
</ul>
<h3 id="schema-version-Pragma"><a href="#schema-version-Pragma" class="headerlink" title="schema_version Pragma"></a>schema_version Pragma</h3><p>schema_version Pragma 获取或设置存储在数据库头中的的架构版本值。语法如下：</p>
<ul>
<li>PRAGMA [database.]schema_version;</li>
<li>PRAGMA [database.]schema_version = number;<br>这是一个 32 位有符号整数值，用来跟踪架构的变化。每当一个架构改变命令执行（比如 CREATE… 或 DROP…）时，这个值会递增。</li>
</ul>
<h3 id="secure-delete-Pragma"><a href="#secure-delete-Pragma" class="headerlink" title="secure_delete Pragma"></a>secure_delete Pragma</h3><p>secure_delete Pragma 用来控制内容是如何从数据库中删除。语法如下：</p>
<ul>
<li>PRAGMA secure_delete;</li>
<li>PRAGMA secure_delete = [true|false];</li>
<li>PRAGMA database.secure_delete;</li>
<li>PRAGMA database.secure_delete = [true|false];<br>安全删除标志的默认值通常是关闭的，但是这是可以通过 SQLITE_SECURE_DELETE 构建选项来改变的。</li>
</ul>
<h3 id="sql-trace-Pragma"><a href="#sql-trace-Pragma" class="headerlink" title="sql_trace Pragma"></a>sql_trace Pragma</h3><p>sql_trace Pragma 用于把 SQL 跟踪结果转储到屏幕上。语法如下：</p>
<ul>
<li>PRAGMA sql_trace;</li>
<li>PRAGMA sql_trace = [true|false];<br>SQLite 必须通过 SQLITE_DEBUG 指令来编译要引用的该 Pragma。</li>
</ul>
<h3 id="synchronous-Pragma"><a href="#synchronous-Pragma" class="headerlink" title="synchronous Pragma"></a>synchronous Pragma</h3><p>synchronous Pragma 获取或设置当前磁盘的同步模式，该模式控制积极的 SQLite 如何将数据写入物理存储。语法如下：</p>
<ul>
<li>PRAGMA [database.]synchronous;</li>
<li>PRAGMA [database.]synchronous = mode;<br>SQLite 支持下列同步模式：</li>
</ul>
<ol>
<li>Pragma 值    描述</li>
<li>0 或 OFF    不进行同步。</li>
<li>1 或 NORMAL    在关键的磁盘操作的每个序列后同步。</li>
<li>2 或 FULL    在每个关键的磁盘操作后同步。</li>
</ol>
<h3 id="temp-store-Pragma"><a href="#temp-store-Pragma" class="headerlink" title="temp_store Pragma"></a>temp_store Pragma</h3><p>temp_store Pragma 获取或设置临时数据库文件所使用的存储模式。语法如下：</p>
<ul>
<li>PRAGMA temp_store;</li>
<li>PRAGMA temp_store = mode;<br>SQLite 支持下列存储模式：</li>
</ul>
<ol start="2">
<li>Pragma 值    描述</li>
<li>0 或 DEFAULT    默认使用编译时的模式。通常是 FILE。</li>
<li>1 或 FILE    使用基于文件的存储。</li>
<li>2 或 MEMORY    使用基于内存的存储。<h3 id="temp-store-directory-Pragma"><a href="#temp-store-directory-Pragma" class="headerlink" title="temp_store_directory Pragma"></a>temp_store_directory Pragma</h3>temp_store_directory Pragma 获取或设置用于临时数据库文件的位置。语法如下：</li>
</ol>
<ul>
<li>PRAGMA temp_store_directory;</li>
<li><p>PRAGMA temp_store_directory = ‘directory_path’;</p>
<h3 id="user-version-Pragma"><a href="#user-version-Pragma" class="headerlink" title="user_version Pragma"></a>user_version Pragma</h3><p>user_version Pragma 获取或设置存储在数据库头的用户自定义的版本值。语法如下：</p>
</li>
<li><p>PRAGMA [database.]user_version;</p>
</li>
<li>PRAGMA [database.]user_version = number;<br>这是一个 32 位的有符号整数值，可以由开发人员设置，用于版本跟踪的目的。</li>
</ul>
<h3 id="writable-schema-Pragma"><a href="#writable-schema-Pragma" class="headerlink" title="writable_schema Pragma"></a>writable_schema Pragma</h3><p>writable_schema Pragma 获取或设置是否能够修改系统表。语法如下：</p>
<ul>
<li>PRAGMA writable_schema;</li>
<li>PRAGMA writable_schema = [true|false];<br>如果设置了该 Pragma，则表以 sqlite_ 开始，可以创建和修改，包括 sqlite_master 表。使用该 Pragma 时要注意，因为它可能导致整个数据库损坏。</li>
</ul>
<h1 id="Chapter-26"><a href="#Chapter-26" class="headerlink" title="Chapter 26"></a>Chapter 26</h1><h2 id="SQLite-Join"><a href="#SQLite-Join" class="headerlink" title="SQLite Join"></a>SQLite Join</h2><p>SQLite 的 Join 子句用于结合两个或多个数据库中表的记录。JOIN 是一种通过共同值来结合两个表中字段的手段。</p>
<h2 id="SQL-定义了三种主要类型的连接："><a href="#SQL-定义了三种主要类型的连接：" class="headerlink" title="SQL 定义了三种主要类型的连接："></a>SQL 定义了三种主要类型的连接：</h2><ul>
<li><p>交叉连接 - CROSS JOIN</p>
</li>
<li><p>内连接 - INNER JOIN</p>
</li>
<li><p>外连接 - OUTER JOIN</p>
</li>
</ul>
<p>在我们继续之前，让我们假设有两个表 COMPANY 和 DEPARTMENT。我们已经看到了用来填充 COMPANY 表的 INSERT 语句。现在让我们假设 COMPANY 表的记录列表如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>另一个表是 DEPARTMENT，定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE DEPARTMENT(</span><br><span class="line">   ID INT PRIMARY KEY      NOT NULL,</span><br><span class="line">   DEPT           CHAR(50) NOT NULL,</span><br><span class="line">   EMP_ID         INT      NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>下面是填充 DEPARTMENT 表的 INSERT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO DEPARTMENT (ID, DEPT, EMP_ID)</span><br><span class="line">VALUES (1, &apos;IT Billing&apos;, 1 );</span><br><span class="line"></span><br><span class="line">INSERT INTO DEPARTMENT (ID, DEPT, EMP_ID)</span><br><span class="line">VALUES (2, &apos;Engineering&apos;, 2 );</span><br><span class="line"></span><br><span class="line">INSERT INTO DEPARTMENT (ID, DEPT, EMP_ID)</span><br><span class="line">VALUES (3, &apos;Finance&apos;, 7 );</span><br></pre></td></tr></table></figure></p>
<p>最后，我们在 DEPARTMENT 表中有下列的记录列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ID          DEPT        EMP_ID</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           IT Billing  1</span><br><span class="line">2           Engineerin  2</span><br><span class="line">3           Finance     7</span><br></pre></td></tr></table></figure></p>
<h2 id="交叉连接-CROSS-JOIN"><a href="#交叉连接-CROSS-JOIN" class="headerlink" title="交叉连接 - CROSS JOIN"></a>交叉连接 - CROSS JOIN</h2><p>交叉连接（CROSS JOIN）把第一个表的每一行与第二个表的每一行进行匹配。如果两个输入表分别有 x 和 y 行，则结果表有 x*y 行。由于交叉连接（CROSS JOIN）有可能产生非常大的表，使用时必须谨慎，只在适当的时候使用它们。</p>
<p>交叉连接的操作，它们都返回被连接的两个表所有数据行的笛卡尔积，返回到的数据行数等于第一个表中符合查询条件的数据行数乘以第二个表中符合查询条件的数据行数。</p>
<p>下面是交叉连接（CROSS JOIN）的语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT ... FROM table1 CROSS JOIN table2 ...</span><br></pre></td></tr></table></figure></p>
<p>基于上面的表，我们可以写一个交叉连接（CROSS JOIN），如下所示：</p>
<p><code>sqlite&gt; SELECT EMP_ID, NAME, DEPT FROM COMPANY CROSS JOIN DEPARTMENT;</code><br>上面的查询会产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      NAME        DEPT</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           Paul        IT Billing</span><br><span class="line">2           Paul        Engineerin</span><br><span class="line">7           Paul        Finance</span><br><span class="line">1           Allen       IT Billing</span><br><span class="line">2           Allen       Engineerin</span><br><span class="line">7           Allen       Finance</span><br><span class="line">1           Teddy       IT Billing</span><br><span class="line">2           Teddy       Engineerin</span><br><span class="line">7           Teddy       Finance</span><br><span class="line">1           Mark        IT Billing</span><br><span class="line">2           Mark        Engineerin</span><br><span class="line">7           Mark        Finance</span><br><span class="line">1           David       IT Billing</span><br><span class="line">2           David       Engineerin</span><br><span class="line">7           David       Finance</span><br><span class="line">1           Kim         IT Billing</span><br><span class="line">2           Kim         Engineerin</span><br><span class="line">7           Kim         Finance</span><br><span class="line">1           James       IT Billing</span><br><span class="line">2           James       Engineerin</span><br><span class="line">7           James       Finance</span><br></pre></td></tr></table></figure></p>
<h2 id="内连接-INNER-JOIN"><a href="#内连接-INNER-JOIN" class="headerlink" title="内连接 - INNER JOIN"></a>内连接 - INNER JOIN</h2><p>内连接（INNER JOIN）根据连接谓词结合两个表（table1 和 table2）的列值来创建一个新的结果表。查询会把 table1 中的每一行与 table2 中的每一行进行比较，找到所有满足连接谓词的行的匹配对。当满足连接谓词时，A 和 B 行的每个匹配对的列值会合并成一个结果行。</p>
<p>内连接（INNER JOIN）是最常见的连接类型，是默认的连接类型。INNER 关键字是可选的。</p>
<p>下面是内连接（INNER JOIN）的语法：</p>
<p><code>SELECT ... FROM table1 [INNER] JOIN table2 ON conditional_expression ...</code><br>为了避免冗余，并保持较短的措辞，可以使用 USING 表达式声明内连接（INNER JOIN）条件。这个表达式指定一个或多个列的列表：</p>
<p><code>SELECT ... FROM table1 JOIN table2 USING ( column1 ,... ) ...</code><br>自然连接（NATURAL JOIN）类似于 JOIN…USING，只是它会自动测试存在两个表中的每一列的值之间相等值：</p>
<p><code>SELECT ... FROM table1 NATURAL JOIN table2...</code><br>基于上面的表，我们可以写一个内连接（INNER JOIN），如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT EMP_ID, NAME, DEPT FROM COMPANY INNER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>上面的查询会产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      NAME        DEPT</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           Paul        IT Billing</span><br><span class="line">2           Allen       Engineerin</span><br><span class="line">7           James       Finance</span><br></pre></td></tr></table></figure></p>
<h2 id="外连接-OUTER-JOIN"><a href="#外连接-OUTER-JOIN" class="headerlink" title="外连接 - OUTER JOIN"></a>外连接 - OUTER JOIN</h2><p>外连接（OUTER JOIN）是内连接（INNER JOIN）的扩展。虽然 SQL 标准定义了三种类型的外连接：LEFT、RIGHT、FULL，但 SQLite 只支持 左外连接（LEFT OUTER JOIN）。</p>
<p>外连接（OUTER JOIN）声明条件的方法与内连接（INNER JOIN）是相同的，使用 ON、USING 或 NATURAL 关键字来表达。最初的结果表以相同的方式进行计算。一旦主连接计算完成，外连接（OUTER JOIN）将从一个或两个表中任何未连接的行合并进来，外连接的列使用 NULL 值，将它们附加到结果表中。</p>
<p>下面是左外连接（LEFT OUTER JOIN）的语法：</p>
<p><code>SELECT ... FROM table1 LEFT OUTER JOIN table2 ON conditional_expression ...</code><br>为了避免冗余，并保持较短的措辞，可以使用 USING 表达式声明外连接（OUTER JOIN）条件。这个表达式指定一个或多个列的列表：</p>
<p><code>SELECT ... FROM table1 LEFT OUTER JOIN table2 USING ( column1 ,... ) ...</code><br>基于上面的表，我们可以写一个外连接（OUTER JOIN），如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT EMP_ID, NAME, DEPT FROM COMPANY LEFT OUTER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>上面的查询会产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      NAME        DEPT</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           Paul        IT Billing</span><br><span class="line">2           Allen       Engineerin</span><br><span class="line">            Teddy</span><br><span class="line">            Mark</span><br><span class="line">            David</span><br><span class="line">            Kim</span><br><span class="line">7           James       Finance</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-27"><a href="#Chapter-27" class="headerlink" title="Chapter 27"></a>Chapter 27</h1><h2 id="SQLite-Unions-子句"><a href="#SQLite-Unions-子句" class="headerlink" title="SQLite Unions 子句"></a>SQLite Unions 子句</h2><p>SQLite的 UNION 子句/运算符用于合并两个或多个 SELECT 语句的结果，不返回任何重复的行。</p>
<p>为了使用 UNION，每个 SELECT 被选择的列数必须是相同的，相同数目的列表达式，相同的数据类型，并确保它们有相同的顺序，但它们不必具有相同的长度。</p>
<h2 id="语法-20"><a href="#语法-20" class="headerlink" title="语法"></a>语法</h2><p>UNION 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1 [, column2 ]</span><br><span class="line">FROM table1 [, table2 ]</span><br><span class="line">[WHERE condition]</span><br><span class="line"></span><br><span class="line">UNION</span><br><span class="line"></span><br><span class="line">SELECT column1 [, column2 ]</span><br><span class="line">FROM table1 [, table2 ]</span><br><span class="line">[WHERE condition]</span><br></pre></td></tr></table></figure></p>
<p>这里给定的条件根据需要可以是任何表达式。</p>
<h2 id="实例-22"><a href="#实例-22" class="headerlink" title="实例"></a>实例</h2><p>假设有下面两个表，（1）COMPANY 表如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select * from COMPANY;</span><br><span class="line">ID          NAME                  AGE         ADDRESS     SALARY</span><br><span class="line">----------  --------------------  ----------  ----------  ----------</span><br><span class="line">1           Paul                  32          California  20000.0</span><br><span class="line">2           Allen                 25          Texas       15000.0</span><br><span class="line">3           Teddy                 23          Norway      20000.0</span><br><span class="line">4           Mark                  25          Rich-Mond   65000.0</span><br><span class="line">5           David                 27          Texas       85000.0</span><br><span class="line">6           Kim                   22          South-Hall  45000.0</span><br><span class="line">7           James                 24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>（2）另一个表是 DEPARTMENT，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          DEPT                  EMP_ID</span><br><span class="line">----------  --------------------  ----------</span><br><span class="line">1           IT Billing            1</span><br><span class="line">2           Engineering           2</span><br><span class="line">3           Finance               7</span><br><span class="line">4           Engineering           3</span><br><span class="line">5           Finance               4</span><br><span class="line">6           Engineering           5</span><br><span class="line">7           Finance               6</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们使用 SELECT 语句及 UNION 子句来连接两个表，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT EMP_ID, NAME, DEPT FROM COMPANY INNER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID</span><br><span class="line">   UNION</span><br><span class="line">     SELECT EMP_ID, NAME, DEPT FROM COMPANY LEFT OUTER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      NAME                  DEPT</span><br><span class="line">----------  --------------------  ----------</span><br><span class="line">1           Paul                  IT Billing</span><br><span class="line">2           Allen                 Engineerin</span><br><span class="line">3           Teddy                 Engineerin</span><br><span class="line">4           Mark                  Finance</span><br><span class="line">5           David                 Engineerin</span><br><span class="line">6           Kim                   Finance</span><br><span class="line">7           James                 Finance</span><br></pre></td></tr></table></figure></p>
<h2 id="UNION-ALL-子句"><a href="#UNION-ALL-子句" class="headerlink" title="UNION ALL 子句"></a>UNION ALL 子句</h2><p>UNION ALL 运算符用于结合两个 SELECT 语句的结果，包括重复行。</p>
<p>适用于 UNION 的规则同样适用于 UNION ALL 运算符。</p>
<h2 id="语法-21"><a href="#语法-21" class="headerlink" title="语法"></a>语法</h2><p>UNION ALL 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1 [, column2 ]</span><br><span class="line">FROM table1 [, table2 ]</span><br><span class="line">[WHERE condition]</span><br><span class="line"></span><br><span class="line">UNION ALL</span><br><span class="line"></span><br><span class="line">SELECT column1 [, column2 ]</span><br><span class="line">FROM table1 [, table2 ]</span><br><span class="line">[WHERE condition]</span><br></pre></td></tr></table></figure></p>
<p>这里给定的条件根据需要可以是任何表达式。</p>
<h2 id="实例-23"><a href="#实例-23" class="headerlink" title="实例"></a>实例</h2><p>现在，让我们使用 SELECT 语句及 UNION ALL 子句来连接两个表，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT EMP_ID, NAME, DEPT FROM COMPANY INNER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID</span><br><span class="line">   UNION ALL</span><br><span class="line">     SELECT EMP_ID, NAME, DEPT FROM COMPANY LEFT OUTER JOIN DEPARTMENT</span><br><span class="line">        ON COMPANY.ID = DEPARTMENT.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      NAME                  DEPT</span><br><span class="line">----------  --------------------  ----------</span><br><span class="line">1           Paul                  IT Billing</span><br><span class="line">2           Allen                 Engineerin</span><br><span class="line">3           Teddy                 Engineerin</span><br><span class="line">4           Mark                  Finance</span><br><span class="line">5           David                 Engineerin</span><br><span class="line">6           Kim                   Finance</span><br><span class="line">7           James                 Finance</span><br><span class="line">1           Paul                  IT Billing</span><br><span class="line">2           Allen                 Engineerin</span><br><span class="line">3           Teddy                 Engineerin</span><br><span class="line">4           Mark                  Finance</span><br><span class="line">5           David                 Engineerin</span><br><span class="line">6           Kim                   Finance</span><br><span class="line">7           James                 Finance</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-28"><a href="#Chapter-28" class="headerlink" title="Chapter 28"></a>Chapter 28</h1><h2 id="SQLite-NULL-值"><a href="#SQLite-NULL-值" class="headerlink" title="SQLite NULL 值"></a>SQLite NULL 值</h2><p>SQLite 的 NULL 是用来表示一个缺失值的项。表中的一个 NULL 值是在字段中显示为空白的一个值。</p>
<p>带有 NULL 值的字段是一个不带有值的字段。NULL 值与零值或包含空格的字段是不同的，理解这点是非常重要的。</p>
<h2 id="语法-22"><a href="#语法-22" class="headerlink" title="语法"></a>语法</h2><p>创建表时使用 NULL 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SQLite&gt; CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>在这里，NOT NULL 表示列总是接受给定数据类型的显式值。这里有两个列我们没有使用 NOT NULL，这意味着这两个列可以为 NULL。</p>
<p>带有 NULL 值的字段在记录创建的时候可以保留为空。</p>
<h2 id="实例-24"><a href="#实例-24" class="headerlink" title="实例"></a>实例</h2><p>NULL 值在选择数据时会引起问题，因为当把一个未知的值与另一个值进行比较时，结果总是未知的，且不会包含在最后的结果中。假设有下面的表，COMPANY 的记录如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>让我们使用 UPDATE 语句来设置一些允许空值的值为 NULL，如下所示：</p>
<p><code>sqlite&gt; UPDATE COMPANY SET ADDRESS = NULL, SALARY = NULL where ID IN(6,7);</code><br>现在，COMPANY 表的记录如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22</span><br><span class="line">7           James       24</span><br></pre></td></tr></table></figure></p>
<p>接下来，让我们看看 IS NOT NULL 运算符的用法，它用来列出所有 SALARY 不为 NULL 的记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT  ID, NAME, AGE, ADDRESS, SALARY</span><br><span class="line">        FROM COMPANY</span><br><span class="line">        WHERE SALARY IS NOT NULL;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句将产生下面的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<p>下面是 IS NULL 运算符的用法，将列出所有 SALARY 为 NULL 的记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT  ID, NAME, AGE, ADDRESS, SALARY</span><br><span class="line">        FROM COMPANY</span><br><span class="line">        WHERE SALARY IS NULL;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句将产生下面的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">6           Kim         22</span><br><span class="line">7           James       24</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-29"><a href="#Chapter-29" class="headerlink" title="Chapter 29"></a>Chapter 29</h1><h2 id="SQLite-别名"><a href="#SQLite-别名" class="headerlink" title="SQLite 别名"></a>SQLite 别名</h2><p>您可以暂时把表或列重命名为另一个名字，这被称为别名。使用表别名是指在一个特定的 SQLite 语句中重命名表。重命名是临时的改变，在数据库中实际的表的名称不会改变。</p>
<p>列别名用来为某个特定的 SQLite 语句重命名表中的列。</p>
<h2 id="语法-23"><a href="#语法-23" class="headerlink" title="语法"></a>语法</h2><p>表 别名的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column1, column2....</span><br><span class="line">FROM table_name AS alias_name</span><br><span class="line">WHERE [condition];</span><br></pre></td></tr></table></figure></p>
<p>列 别名的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name AS alias_name</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition];</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-25"><a href="#实例-25" class="headerlink" title="实例"></a>实例</h2><p>假设有下面两个表，（1）COMPANY 表如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select * from COMPANY;</span><br><span class="line">ID          NAME                  AGE         ADDRESS     SALARY</span><br><span class="line">----------  --------------------  ----------  ----------  ----------</span><br><span class="line">1           Paul                  32          California  20000.0</span><br><span class="line">2           Allen                 25          Texas       15000.0</span><br><span class="line">3           Teddy                 23          Norway      20000.0</span><br><span class="line">4           Mark                  25          Rich-Mond   65000.0</span><br><span class="line">5           David                 27          Texas       85000.0</span><br><span class="line">6           Kim                   22          South-Hall  45000.0</span><br><span class="line">7           James                 24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>（2）另一个表是 DEPARTMENT，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          DEPT                  EMP_ID</span><br><span class="line">----------  --------------------  ----------</span><br><span class="line">1           IT Billing            1</span><br><span class="line">2           Engineering           2</span><br><span class="line">3           Finance               7</span><br><span class="line">4           Engineering           3</span><br><span class="line">5           Finance               4</span><br><span class="line">6           Engineering           5</span><br><span class="line">7           Finance               6</span><br></pre></td></tr></table></figure></p>
<p>现在，下面是 表别名 的用法，在这里我们使用 C 和 D 分别作为 COMPANY 和 DEPARTMENT 表的别名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT C.ID, C.NAME, C.AGE, D.DEPT</span><br><span class="line">        FROM COMPANY AS C, DEPARTMENT AS D</span><br><span class="line">        WHERE  C.ID = D.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句将产生下面的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         DEPT</span><br><span class="line">----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          IT Billing</span><br><span class="line">2           Allen       25          Engineerin</span><br><span class="line">3           Teddy       23          Engineerin</span><br><span class="line">4           Mark        25          Finance</span><br><span class="line">5           David       27          Engineerin</span><br><span class="line">6           Kim         22          Finance</span><br><span class="line">7           James       24          Finance</span><br></pre></td></tr></table></figure></p>
<p>让我们看一个 列别名 的实例，在这里 COMPANY_ID 是 ID 列的别名，COMPANY_NAME 是 name 列的别名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT C.ID AS COMPANY_ID, C.NAME AS COMPANY_NAME, C.AGE, D.DEPT</span><br><span class="line">        FROM COMPANY AS C, DEPARTMENT AS D</span><br><span class="line">        WHERE  C.ID = D.EMP_ID;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句将产生下面的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">COMPANY_ID  COMPANY_NAME  AGE         DEPT</span><br><span class="line">----------  ------------  ----------  ----------</span><br><span class="line">1           Paul          32          IT Billing</span><br><span class="line">2           Allen         25          Engineerin</span><br><span class="line">3           Teddy         23          Engineerin</span><br><span class="line">4           Mark          25          Finance</span><br><span class="line">5           David         27          Engineerin</span><br><span class="line">6           Kim           22          Finance</span><br><span class="line">7           James         24          Finance</span><br></pre></td></tr></table></figure></p>
<p>和其他数据库类似，别名的关键字 as 可以被省略<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT id AS identification, name AS nickname FROM company;</span><br><span class="line">SELECT id identification, name AS nickname FROM company;</span><br></pre></td></tr></table></figure></p>
<p>结果是完全一样的。</p>
<h1 id="Chapter-30"><a href="#Chapter-30" class="headerlink" title="Chapter 30"></a>Chapter 30</h1><h2 id="SQLite-触发器（Trigger）"><a href="#SQLite-触发器（Trigger）" class="headerlink" title="SQLite 触发器（Trigger）"></a>SQLite 触发器（Trigger）</h2><p>SQLite 触发器（Trigger）是数据库的回调函数，它会在指定的数据库事件发生时自动执行/调用。以下是关于 SQLite 的触发器（Trigger）的要点：</p>
<ol>
<li><p>SQLite 的触发器（Trigger）可以指定在特定的数据库表发生 DELETE、INSERT 或 UPDATE 时触发，或在一个或多个指定表的列发生更新时触发。</p>
</li>
<li><p>SQLite 只支持 FOR EACH ROW 触发器（Trigger），没有 FOR EACH STATEMENT 触发器（Trigger）。因此，明确指定 FOR EACH ROW 是可选的。</p>
</li>
<li><p>WHEN 子句和触发器（Trigger）动作可能访问使用表单 NEW.column-name 和 OLD.column-name 的引用插入、删除或更新的行元素，其中 column-name 是从与触发器关联的表的列的名称。</p>
</li>
<li><p>如果提供 WHEN 子句，则只针对 WHEN 子句为真的指定行执行 SQL 语句。如果没有提供 WHEN 子句，则针对所有行执行 SQL 语句。</p>
</li>
<li><p>BEFORE 或 AFTER 关键字决定何时执行触发器动作，决定是在关联行的插入、修改或删除之前或者之后执行触发器动作。</p>
</li>
<li><p>当触发器相关联的表删除时，自动删除触发器（Trigger）。</p>
</li>
<li><p>要修改的表必须存在于同一数据库中，作为触发器被附加的表或视图，且必须只使用 tablename，而不是 database.tablename。</p>
</li>
<li><p>一个特殊的 SQL 函数 RAISE() 可用于触发器程序内抛出异常。</p>
</li>
</ol>
<h2 id="语法-24"><a href="#语法-24" class="headerlink" title="语法"></a>语法</h2><p>创建 触发器（Trigger） 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE  TRIGGER trigger_name [BEFORE|AFTER] event_name </span><br><span class="line">ON table_name</span><br><span class="line">BEGIN</span><br><span class="line"> -- Trigger logic goes here....</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></p>
<p>在这里，event_name 可以是在所提到的表 table_name 上的 INSERT、DELETE 和 UPDATE 数据库操作。您可以在表名后选择指定 FOR EACH ROW。</p>
<p>以下是在 UPDATE 操作上在表的一个或多个指定列上创建触发器（Trigger）的语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE  TRIGGER trigger_name [BEFORE|AFTER] UPDATE OF column_name </span><br><span class="line">ON table_name</span><br><span class="line">BEGIN</span><br><span class="line"> -- Trigger logic goes here....</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-26"><a href="#实例-26" class="headerlink" title="实例"></a>实例</h2><p>让我们假设一个情况，我们要为被插入到新创建的 COMPANY 表（如果已经存在，则删除重新创建）中的每一个记录保持审计试验：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE COMPANY(</span><br><span class="line">   ID INT PRIMARY KEY     NOT NULL,</span><br><span class="line">   NAME           TEXT    NOT NULL,</span><br><span class="line">   AGE            INT     NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>为了保持审计试验，我们将创建一个名为 AUDIT 的新表。每当 COMPANY 表中有一个新的记录项时，日志消息将被插入其中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE AUDIT(</span><br><span class="line">    EMP_ID INT NOT NULL,</span><br><span class="line">    ENTRY_DATE TEXT NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>在这里，ID 是 AUDIT 记录的 ID，EMP_ID 是来自 COMPANY 表的 ID，DATE 将保持 COMPANY 中记录被创建时的时间戳。所以，现在让我们在 COMPANY 表上创建一个触发器，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TRIGGER audit_log AFTER INSERT </span><br><span class="line">ON COMPANY</span><br><span class="line">BEGIN</span><br><span class="line">   INSERT INTO AUDIT(EMP_ID, ENTRY_DATE) VALUES (new.ID, datetime(&apos;now&apos;));</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></p>
<p>现在，我们将开始在 COMPANY 表中插入记录，这将导致在 AUDIT 表中创建一个审计日志记录。因此，让我们在 COMPANY 表中创建一个记录，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (1, &apos;Paul&apos;, 32, &apos;California&apos;, 20000.00 );</span><br><span class="line">这将在 COMPANY 表中创建如下一个记录：</span><br><span class="line"></span><br><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br></pre></td></tr></table></figure></p>
<p>同时，将在 AUDIT 表中创建一个记录。这个纪录是触发器的结果，这是我们在 COMPANY 表上的 INSERT 操作上创建的触发器（Trigger）。类似的，可以根据需要在 UPDATE 和 DELETE 操作上创建触发器（Trigger）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EMP_ID      ENTRY_DATE</span><br><span class="line">----------  -------------------</span><br><span class="line">1           2013-04-05 06:26:00</span><br></pre></td></tr></table></figure></p>
<h2 id="列出触发器（TRIGGERS）"><a href="#列出触发器（TRIGGERS）" class="headerlink" title="列出触发器（TRIGGERS）"></a>列出触发器（TRIGGERS）</h2><p>您可以从 sqlite_master 表中列出所有触发器，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT name FROM sqlite_master</span><br><span class="line">WHERE type = &apos;trigger&apos;;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句只会列出一个条目，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name</span><br><span class="line">----------</span><br><span class="line">audit_log</span><br></pre></td></tr></table></figure></p>
<p>如果您想要列出特定表上的触发器，则使用 AND 子句连接表名，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT name FROM sqlite_master</span><br><span class="line">WHERE type = &apos;trigger&apos; AND tbl_name = &apos;COMPANY&apos;;</span><br></pre></td></tr></table></figure></p>
<p>上面的 SQLite 语句只会列出一个条目，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name</span><br><span class="line">----------</span><br><span class="line">audit_log</span><br></pre></td></tr></table></figure></p>
<h2 id="删除触发器（TRIGGERS）"><a href="#删除触发器（TRIGGERS）" class="headerlink" title="删除触发器（TRIGGERS）"></a>删除触发器（TRIGGERS）</h2><p>下面是 DROP 命令，可用于删除已有的触发器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; DROP TRIGGER trigger_name;</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-31"><a href="#Chapter-31" class="headerlink" title="Chapter 31"></a>Chapter 31</h1><h2 id="SQLite-索引（Index）"><a href="#SQLite-索引（Index）" class="headerlink" title="SQLite 索引（Index）"></a>SQLite 索引（Index）</h2><p>索引（Index）是一种特殊的查找表，数据库搜索引擎用来加快数据检索。<strong>简单地说，索引是一个指向表中数据的指针。一个数据库中的索引与一本书后边的索引是非常相似的。</strong></p>
<p>例如，如果您想在一本讨论某个话题的书中引用所有页面，您首先需要指向索引，索引按字母顺序列出了所有主题，然后指向一个或多个特定的页码。</p>
<p>索引有助于加快 SELECT 查询和 WHERE 子句，但它会减慢使用 UPDATE 和 INSERT 语句时的数据输入。索引可以创建或删除，但不会影响数据。</p>
<p>使用 CREATE INDEX 语句创建索引，它允许命名索引，指定表及要索引的一列或多列，并指示索引是升序排列还是降序排列。</p>
<p>索引也可以是唯一的，与 UNIQUE 约束类似，在列上或列组合上防止重复条目。</p>
<h2 id="CREATE-INDEX-命令"><a href="#CREATE-INDEX-命令" class="headerlink" title="CREATE INDEX 命令"></a>CREATE INDEX 命令</h2><p>CREATE INDEX 的基本语法如下：</p>
<p><code>CREATE INDEX index_name ON table_name;</code></p>
<h2 id="单列索引"><a href="#单列索引" class="headerlink" title="单列索引"></a>单列索引</h2><p>单列索引是一个只基于表的一个列上创建的索引。基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX index_name</span><br><span class="line">ON table_name (column_name);</span><br></pre></td></tr></table></figure></p>
<h2 id="唯一索引"><a href="#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h2><p>使用唯一索引不仅是为了性能，同时也为了数据的完整性。唯一索引不允许任何重复的值插入到表中。基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE UNIQUE INDEX index_name</span><br><span class="line">on table_name (column_name);</span><br></pre></td></tr></table></figure></p>
<h2 id="组合索引"><a href="#组合索引" class="headerlink" title="组合索引"></a>组合索引</h2><p>组合索引是基于一个表的两个或多个列上创建的索引。基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX index_name</span><br><span class="line">on table_name (column1, column2);</span><br></pre></td></tr></table></figure></p>
<p>是否要创建一个单列索引还是组合索引，要考虑到您在作为查询过滤条件的 WHERE 子句中使用非常频繁的列。</p>
<p>如果值使用到一个列，则选择使用单列索引。如果在作为过滤的 WHERE 子句中有两个或多个列经常使用，则选择使用组合索引。</p>
<h2 id="隐式索引"><a href="#隐式索引" class="headerlink" title="隐式索引"></a>隐式索引</h2><p>隐式索引是在创建对象时，由数据库服务器自动创建的索引。索引自动创建为主键约束和唯一约束。</p>
<h2 id="实例-27"><a href="#实例-27" class="headerlink" title="实例"></a>实例</h2><p>下面是一个例子，我们将在 COMPANY 表的 salary 列上创建一个索引：</p>
<p><code>sqlite&gt; CREATE INDEX salary_index ON COMPANY (salary);</code><br>现在，让我们使用 .indices 或 .indexes 命令列出 COMPANY 表上所有可用的索引，如下所示：</p>
<p><code>sqlite&gt; .indices COMPANY</code><br>这将产生如下结果，其中 sqlite_autoindex_COMPANY_1 是创建表时创建的隐式索引。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">salary_index</span><br><span class="line">sqlite_autoindex_COMPANY_1</span><br></pre></td></tr></table></figure></p>
<p>您可以列出数据库范围的所有索引，如下所示：</p>
<p><code>sqlite&gt; SELECT * FROM sqlite_master WHERE type = &#39;index&#39;;</code></p>
<h2 id="DROP-INDEX-命令"><a href="#DROP-INDEX-命令" class="headerlink" title="DROP INDEX 命令"></a>DROP INDEX 命令</h2><p>一个索引可以使用 SQLite 的 DROP 命令删除。当删除索引时应特别注意，因为性能可能会下降或提高。</p>
<p>基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX index_name;</span><br></pre></td></tr></table></figure></p>
<p>您可以使用下面的语句来删除之前创建的索引：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; DROP INDEX salary_index;</span><br></pre></td></tr></table></figure></p>
<h2 id="什么情况下要避免使用索引？"><a href="#什么情况下要避免使用索引？" class="headerlink" title="什么情况下要避免使用索引？"></a>什么情况下要避免使用索引？</h2><p>虽然索引的目的在于提高数据库的性能，但这里有几个情况需要避免使用索引。使用索引时，应重新考虑下列准则：</p>
<ol>
<li><p>索引不应该使用在较小的表上。</p>
</li>
<li><p>索引不应该使用在有频繁的大批量的更新或插入操作的表上。</p>
</li>
<li><p>索引不应该使用在含有大量的 NULL 值的列上。</p>
</li>
<li><p>索引不应该使用在频繁操作的列上。</p>
</li>
</ol>
<h1 id="Chapter-32"><a href="#Chapter-32" class="headerlink" title="Chapter 32"></a>Chapter 32</h1><h2 id="SQLite-Indexed-By"><a href="#SQLite-Indexed-By" class="headerlink" title="SQLite Indexed By"></a>SQLite Indexed By</h2><p>“INDEXED BY index-name” 子句规定必须需要命名的索引来查找前面表中值。</p>
<p>如果索引名 index-name 不存在或不能用于查询，然后 SQLite 语句的准备失败。</p>
<p>“NOT INDEXED” 子句规定当访问前面的表（包括由 UNIQUE 和 PRIMARY KEY 约束创建的隐式索引）时，没有使用索引。</p>
<p>然而，即使指定了 “NOT INDEXED”，INTEGER PRIMARY KEY 仍然可以被用于查找条目。</p>
<h2 id="语法-25"><a href="#语法-25" class="headerlink" title="语法"></a>语法</h2><p>下面是 INDEXED BY 子句的语法，它可以与 DELETE、UPDATE 或 SELECT 语句一起使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT|DELETE|UPDATE column1, column2...</span><br><span class="line">INDEXED BY (index_name)</span><br><span class="line">table_name</span><br><span class="line">WHERE (CONDITION);</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-28"><a href="#实例-28" class="headerlink" title="实例"></a>实例</h2><p>假设有表 COMPANY，我们将创建一个索引，并用它进行 INDEXED BY 操作。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE INDEX salary_index ON COMPANY(salary);</span><br><span class="line">sqlite&gt;</span><br></pre></td></tr></table></figure></p>
<p>现在使用 INDEXED BY 子句从表 COMPANY 中选择数据，如下所示：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY INDEXED BY salary_index WHERE salary &gt; 5000;</code></p>
<h1 id="Chapter-33"><a href="#Chapter-33" class="headerlink" title="Chapter 33"></a>Chapter 33</h1><h2 id="SQLite-Alter-命令"><a href="#SQLite-Alter-命令" class="headerlink" title="SQLite Alter 命令"></a>SQLite Alter 命令</h2><p>SQLite 的 ALTER TABLE 命令不通过执行一个完整的转储和数据的重载来修改已有的表。您可以使用 ALTER TABLE 语句重命名表，使用 ALTER TABLE 语句还可以在已有的表中添加额外的列。</p>
<p>在 SQLite 中，除了重命名表和在已有的表中添加列，ALTER TABLE 命令不支持其他操作。</p>
<h2 id="语法-26"><a href="#语法-26" class="headerlink" title="语法"></a>语法</h2><p>用来重命名已有的表的 ALTER TABLE 的基本语法如下：</p>
<p><code>ALTER TABLE database_name.table_name RENAME TO new_table_name;</code><br>用来在已有的表中添加一个新的列的 ALTER TABLE 的基本语法如下：</p>
<p><code>ALTER TABLE database_name.table_name ADD COLUMN column_def...;</code></p>
<h2 id="实例-29"><a href="#实例-29" class="headerlink" title="实例"></a>实例</h2><p>假设我们的 COMPANY 表有如下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们尝试使用 ALTER TABLE 语句重命名该表，如下所示：</p>
<p><code>sqlite&gt; ALTER TABLE COMPANY RENAME TO OLD_COMPANY;</code><br>上面的 SQLite 语句将重命名 COMPANY 表为 OLD_COMPANY。现在，让我们尝试在 OLD_COMPANY 表中添加一个新的列，如下所示：</p>
<p><code>sqlite&gt; ALTER TABLE OLD_COMPANY ADD COLUMN SEX char(1);</code><br>现在，COMPANY 表已经改变，使用 SELECT 语句输出如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY      SEX</span><br><span class="line">----------  ----------  ----------  ----------  ----------  ---</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>请注意，新添加的列是以 NULL 值来填充的。</p>
<p>sqlite3 并不支持直接添加带有 unique 约束的列：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; alter table company add department text unique;</span><br><span class="line">Error: Cannot add a UNIQUE column</span><br></pre></td></tr></table></figure></p>
<p>可以先直接添加一列数据，然后再添加 unique 索引。其实在建表的时候如果列有 unique 约束，通过查询系统表 SQLITE_MASTER 可以看到，会自动创建相应的索引。</p>
<p>SQLITE_TEMP_MASTER 跟 SQLITE_MASTER 是 sqlite 的系统表，SQLITE_TEMP_MASTER 表存储临时表有关的所有内容。</p>
<h1 id="Chapter-34"><a href="#Chapter-34" class="headerlink" title="Chapter 34"></a>Chapter 34</h1><h2 id="SQLite-Truncate-Table"><a href="#SQLite-Truncate-Table" class="headerlink" title="SQLite Truncate Table"></a>SQLite Truncate Table</h2><p>在 SQLite 中，并没有 TRUNCATE TABLE 命令，但可以使用 SQLite 的 DELETE 命令从已有的表中删除全部的数据。</p>
<h2 id="语法-27"><a href="#语法-27" class="headerlink" title="语法"></a>语法</h2><p>DELETE 命令的基本语法如下：</p>
<p><code>sqlite&gt; DELETE FROM table_name;</code><br>但这种方法无法将递增数归零。</p>
<p>如果要将递增数归零，可以使用以下方法：</p>
<p><code>sqlite&gt; DELETE FROM sqlite_sequence WHERE name = &#39;table_name&#39;;</code><br>当 SQLite 数据库中包含自增列时，会自动建立一个名为 sqlite_sequence 的表。这个表包含两个列：name 和 seq。name 记录自增列所在的表，seq 记录当前序号（下一条记录的编号就是当前序号加 1）。如果想把某个自增列的序号归零，只需要修改 sqlite_sequence 表就可以了。</p>
<p><code>UPDATE sqlite_sequence SET seq = 0 WHERE name = &#39;table_name&#39;;</code></p>
<h2 id="实例-30"><a href="#实例-30" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有如下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>下面为删除上表记录的实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SQLite&gt; DELETE FROM sqlite_sequence WHERE name = &apos;COMPANY&apos;;</span><br><span class="line">SQLite&gt; VACUUM;</span><br></pre></td></tr></table></figure></p>
<p>现在，COMPANY 表中的记录完全被删除，使用 SELECT 语句将没有任何输出。</p>
<h1 id="Chapter-35"><a href="#Chapter-35" class="headerlink" title="Chapter 35"></a>Chapter 35</h1><h2 id="SQLite-视图（View）"><a href="#SQLite-视图（View）" class="headerlink" title="SQLite 视图（View）"></a>SQLite 视图（View）</h2><p>视图（View）只不过是通过相关的名称存储在数据库中的一个 SQLite 语句。视图（View）实际上是一个以预定义的 SQLite 查询形式存在的表的组合。</p>
<p>视图（View）可以包含一个表的所有行或从一个或多个表选定行。视图（View）可以从一个或多个表创建，这取决于要创建视图的 SQLite 查询。、</p>
<p>视图（View）是一种虚表，允许用户实现以下几点：</p>
<ul>
<li><p>用户或用户组查找结构数据的方式更自然或直观。</p>
</li>
<li><p>限制数据访问，用户只能看到有限的数据，而不是完整的表。</p>
</li>
<li><p>汇总各种表中的数据，用于生成报告。</p>
</li>
</ul>
<p>SQLite 视图是只读的，因此可能无法在视图上执行 DELETE、INSERT 或 UPDATE 语句。但是可以在视图上创建一个触发器，当尝试 DELETE、INSERT 或 UPDATE 视图时触发，需要做的动作在触发器内容中定义。</p>
<h2 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h2><p>SQLite 的视图是使用 CREATE VIEW 语句创建的。SQLite 视图可以从一个单一的表、多个表或其他视图创建。</p>
<p>CREATE VIEW 的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE [TEMP | TEMPORARY] VIEW view_name AS</span><br><span class="line">SELECT column1, column2.....</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE [condition];</span><br></pre></td></tr></table></figure></p>
<p>您可以在 SELECT 语句中包含多个表，这与在正常的 SQL SELECT 查询中的方式非常相似。如果使用了可选的 TEMP 或 TEMPORARY 关键字，则将在临时数据库中创建视图。</p>
<h2 id="实例-31"><a href="#实例-31" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，下面是一个从 COMPANY 表创建视图的实例。视图只从 COMPANY 表中选取几列：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE VIEW COMPANY_VIEW AS</span><br><span class="line">SELECT ID, NAME, AGE</span><br><span class="line">FROM  COMPANY;</span><br></pre></td></tr></table></figure></p>
<p>现在，可以查询 COMPANY_VIEW，与查询实际表的方式类似。下面是实例：</p>
<p><code>sqlite&gt; SELECT * FROM COMPANY_VIEW;</code><br>这将产生以下结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE</span><br><span class="line">----------  ----------  ----------</span><br><span class="line">1           Paul        32</span><br><span class="line">2           Allen       25</span><br><span class="line">3           Teddy       23</span><br><span class="line">4           Mark        25</span><br><span class="line">5           David       27</span><br><span class="line">6           Kim         22</span><br><span class="line">7           James       24</span><br></pre></td></tr></table></figure></p>
<p>删除视图<br>要删除视图，只需使用带有 view_name 的 DROP VIEW 语句。DROP VIEW 的基本语法如下：</p>
<p><code>sqlite&gt; DROP VIEW view_name;</code><br>下面的命令将删除我们在前面创建的 COMPANY_VIEW 视图：</p>
<p><code>sqlite&gt; DROP VIEW COMPANY_VIEW;</code></p>
<h1 id="Chapter-36"><a href="#Chapter-36" class="headerlink" title="Chapter 36"></a>Chapter 36</h1><h2 id="SQLite-事务（Transaction）"><a href="#SQLite-事务（Transaction）" class="headerlink" title="SQLite 事务（Transaction）"></a>SQLite 事务（Transaction）</h2><p>事务（Transaction）是一个对数据库执行工作单元。事务（Transaction）是以逻辑顺序完成的工作单位或序列，可以是由用户手动操作完成，也可以是由某种数据库程序自动完成。</p>
<p>事务（Transaction）是指一个或多个更改数据库的扩展。例如，如果您正在创建一个记录或者更新一个记录或者从表中删除一个记录，那么您正在该表上执行事务。重要的是要控制事务以确保数据的完整性和处理数据库错误。</p>
<p>实际上，您可以把许多的 SQLite 查询联合成一组，把所有这些放在一起作为事务的一部分进行执行。</p>
<h2 id="事务的属性"><a href="#事务的属性" class="headerlink" title="事务的属性"></a>事务的属性</h2><p>事务（Transaction）具有以下四个标准属性，通常根据首字母缩写为 ACID：</p>
<ol>
<li><p>原子性（Atomicity）：确保工作单位内的所有操作都成功完成，否则，事务会在出现故障时终止，之前的操作也会回滚到以前的状态。</p>
</li>
<li><p>一致性（Consistency)：确保数据库在成功提交的事务上正确地改变状态。</p>
</li>
<li><p>隔离性（Isolation）：使事务操作相互独立和透明。</p>
</li>
<li><p>持久性（Durability）：确保已提交事务的结果或效果在系统发生故障的情况下仍然存在。</p>
</li>
</ol>
<h2 id="事务控制"><a href="#事务控制" class="headerlink" title="事务控制"></a>事务控制</h2><p>使用下面的命令来控制事务：</p>
<ol>
<li><p>BEGIN TRANSACTION：开始事务处理。</p>
</li>
<li><p>COMMIT：保存更改，或者可以使用 END TRANSACTION 命令。</p>
</li>
<li><p>ROLLBACK：回滚所做的更改。</p>
</li>
</ol>
<p>事务控制命令只与 DML 命令 INSERT、UPDATE 和 DELETE 一起使用。他们不能在创建表或删除表时使用，因为这些操作在数据库中是自动提交的。</p>
<h2 id="BEGIN-TRANSACTION-命令"><a href="#BEGIN-TRANSACTION-命令" class="headerlink" title="BEGIN TRANSACTION 命令"></a>BEGIN TRANSACTION 命令</h2><p>事务（Transaction）可以使用 BEGIN TRANSACTION 命令或简单的 BEGIN 命令来启动。此类事务通常会持续执行下去，直到遇到下一个 COMMIT 或 ROLLBACK 命令。不过在数据库关闭或发生错误时，事务处理也会回滚。以下是启动一个事务的简单语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BEGIN;</span><br><span class="line"></span><br><span class="line">or </span><br><span class="line"></span><br><span class="line">BEGIN TRANSACTION;</span><br></pre></td></tr></table></figure></p>
<h2 id="COMMIT-命令"><a href="#COMMIT-命令" class="headerlink" title="COMMIT 命令"></a>COMMIT 命令</h2><p>COMMIT 命令是用于把事务调用的更改保存到数据库中的事务命令。</p>
<p>COMMIT 命令把自上次 COMMIT 或 ROLLBACK 命令以来的所有事务保存到数据库。</p>
<p>COMMIT 命令的语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">END TRANSACTION;</span><br></pre></td></tr></table></figure></p>
<h2 id="ROLLBACK-命令"><a href="#ROLLBACK-命令" class="headerlink" title="ROLLBACK 命令"></a>ROLLBACK 命令</h2><p>ROLLBACK 命令是用于撤消尚未保存到数据库的事务的事务命令。</p>
<p>ROLLBACK 命令只能用于撤销自上次发出 COMMIT 或 ROLLBACK 命令以来的事务。</p>
<p>ROLLBACK 命令的语法如下：</p>
<p><code>ROLLBACK;</code></p>
<h2 id="实例-32"><a href="#实例-32" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们开始一个事务，并从表中删除 age = 25 的记录，最后，我们使用 ROLLBACK 命令撤消所有的更改。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; BEGIN;</span><br><span class="line">sqlite&gt; DELETE FROM COMPANY WHERE AGE = 25;</span><br><span class="line">sqlite&gt; ROLLBACK;</span><br></pre></td></tr></table></figure></p>
<p>检查 COMPANY 表，仍然有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们开始另一个事务，从表中删除 age = 25 的记录，最后我们使用 COMMIT 命令提交所有的更改。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; BEGIN;</span><br><span class="line">sqlite&gt; DELETE FROM COMPANY WHERE AGE = 25;</span><br><span class="line">sqlite&gt; COMMIT;</span><br></pre></td></tr></table></figure></p>
<p>检查 COMPANY 表，有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-37"><a href="#Chapter-37" class="headerlink" title="Chapter 37"></a>Chapter 37</h1><h2 id="SQLite-子查询"><a href="#SQLite-子查询" class="headerlink" title="SQLite 子查询"></a>SQLite 子查询</h2><p>子查询或内部查询或嵌套查询是在另一个 SQLite 查询内嵌入在 WHERE 子句中的查询。</p>
<p><strong>使用子查询返回的数据将被用在主查询中作为条件，以进一步限制要检索的数据。</strong></p>
<p>子查询可以与 SELECT、INSERT、UPDATE 和 DELETE 语句一起使用，可伴随着使用运算符如 =、&lt;、&gt;、&gt;=、&lt;=、IN、BETWEEN 等。</p>
<p>以下是子查询必须遵循的几个规则：</p>
<ol>
<li><p>子查询必须用括号括起来。</p>
</li>
<li><p>子查询在 SELECT 子句中只能有一个列，除非在主查询中有多列，与子查询的所选列进行比较。</p>
</li>
<li><p>ORDER BY 不能用在子查询中，虽然主查询可以使用 ORDER BY。可以在子查询中使用 GROUP BY，功能与 ORDER BY 相同。</p>
</li>
<li><p>子查询返回多于一行，只能与多值运算符一起使用，如 IN 运算符。</p>
</li>
<li><p>BETWEEN 运算符不能与子查询一起使用，但是，BETWEEN 可在子查询内使用。</p>
</li>
</ol>
<h2 id="SELECT-语句中的子查询使用"><a href="#SELECT-语句中的子查询使用" class="headerlink" title="SELECT 语句中的子查询使用"></a>SELECT 语句中的子查询使用</h2><p>子查询通常与 SELECT 语句一起使用。基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name [, column_name ]</span><br><span class="line">FROM   table1 [, table2 ]</span><br><span class="line">WHERE  column_name OPERATOR</span><br><span class="line">      (SELECT column_name [, column_name ]</span><br><span class="line">      FROM table1 [, table2 ]</span><br><span class="line">      [WHERE])</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-33"><a href="#实例-33" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们检查 SELECT 语句中的子查询使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT * </span><br><span class="line">     FROM COMPANY </span><br><span class="line">     WHERE ID IN (SELECT ID </span><br><span class="line">                  FROM COMPANY </span><br><span class="line">                  WHERE SALARY &gt; 45000) ;</span><br></pre></td></tr></table></figure></p>
<p>这将产生以下结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="INSERT-语句中的子查询使用"><a href="#INSERT-语句中的子查询使用" class="headerlink" title="INSERT 语句中的子查询使用"></a>INSERT 语句中的子查询使用</h2><p>子查询也可以与 INSERT 语句一起使用。INSERT 语句使用子查询返回的数据插入到另一个表中。在子查询中所选择的数据可以用任何字符、日期或数字函数修改。</p>
<h2 id="基本语法如下："><a href="#基本语法如下：" class="headerlink" title="基本语法如下："></a>基本语法如下：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table_name [ (column1 [, column2 ]) ]</span><br><span class="line">           SELECT [ *|column1 [, column2 ]</span><br><span class="line">           FROM table1 [, table2 ]</span><br><span class="line">           [ WHERE VALUE OPERATOR ]</span><br></pre></td></tr></table></figure>
<h2 id="实例-34"><a href="#实例-34" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY_BKP 的结构与 COMPANY 表相似，且可使用相同的 CREATE TABLE 进行创建，只是表名改为 COMPANY_BKP。现在把整个 COMPANY 表复制到 COMPANY_BKP，语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; INSERT INTO COMPANY_BKP</span><br><span class="line">     SELECT * FROM COMPANY </span><br><span class="line">     WHERE ID IN (SELECT ID </span><br><span class="line">                  FROM COMPANY) ;</span><br></pre></td></tr></table></figure></p>
<h2 id="UPDATE-语句中的子查询使用"><a href="#UPDATE-语句中的子查询使用" class="headerlink" title="UPDATE 语句中的子查询使用"></a>UPDATE 语句中的子查询使用</h2><p>子查询可以与 UPDATE 语句结合使用。当通过 UPDATE 语句使用子查询时，表中单个或多个列被更新。</p>
<h2 id="基本语法如下：-1"><a href="#基本语法如下：-1" class="headerlink" title="基本语法如下："></a>基本语法如下：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table</span><br><span class="line">SET column_name = new_value</span><br><span class="line">[ WHERE OPERATOR [ VALUE ]</span><br><span class="line">   (SELECT COLUMN_NAME</span><br><span class="line">   FROM TABLE_NAME)</span><br><span class="line">   [ WHERE) ]</span><br></pre></td></tr></table></figure>
<h2 id="实例-35"><a href="#实例-35" class="headerlink" title="实例"></a>实例</h2><p>假设，我们有 COMPANY_BKP 表，是 COMPANY 表的备份。</p>
<p>下面的实例把 COMPANY 表中所有 AGE 大于或等于 27 的客户的 SALARY 更新为原来的 0.50 倍：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; UPDATE COMPANY</span><br><span class="line">     SET SALARY = SALARY * 0.50</span><br><span class="line">     WHERE AGE IN (SELECT AGE FROM COMPANY_BKP</span><br><span class="line">                   WHERE AGE &gt;= 27 );</span><br></pre></td></tr></table></figure></p>
<p>这将影响两行，最后 COMPANY 表中的记录如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  10000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       42500.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="DELETE-语句中的子查询使用"><a href="#DELETE-语句中的子查询使用" class="headerlink" title="DELETE 语句中的子查询使用"></a>DELETE 语句中的子查询使用</h2><p>子查询可以与 DELETE 语句结合使用，就像上面提到的其他语句一样。</p>
<h2 id="基本语法如下：-2"><a href="#基本语法如下：-2" class="headerlink" title="基本语法如下："></a>基本语法如下：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM TABLE_NAME</span><br><span class="line">[ WHERE OPERATOR [ VALUE ]</span><br><span class="line">   (SELECT COLUMN_NAME</span><br><span class="line">   FROM TABLE_NAME)</span><br><span class="line">   [ WHERE) ]</span><br></pre></td></tr></table></figure>
<h2 id="实例-36"><a href="#实例-36" class="headerlink" title="实例"></a>实例</h2><p>假设，我们有 COMPANY_BKP 表，是 COMPANY 表的备份。</p>
<p>下面的实例删除 COMPANY 表中所有 AGE 大于或等于 27 的客户记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; DELETE FROM COMPANY</span><br><span class="line">     WHERE AGE IN (SELECT AGE FROM COMPANY_BKP</span><br><span class="line">                   WHERE AGE &gt; 27 );</span><br></pre></td></tr></table></figure></p>
<p>这将影响两行，最后 COMPANY 表中的记录如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       42500.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-38"><a href="#Chapter-38" class="headerlink" title="Chapter 38"></a>Chapter 38</h1><h2 id="SQLite-Autoincrement（自动递增）"><a href="#SQLite-Autoincrement（自动递增）" class="headerlink" title="SQLite Autoincrement（自动递增）"></a>SQLite Autoincrement（自动递增）</h2><p>SQLite 的 <strong>AUTOINCREMENT</strong> 是一个<strong>关键字</strong>，用于表中的字段值自动递增。我们可以在创建表时在特定的列名称上使用 AUTOINCREMENT 关键字实现该字段值的自动增加。</p>
<p><strong>关键字 AUTOINCREMENT 只能用于整型（INTEGER）字段。</strong></p>
<h2 id="语法-28"><a href="#语法-28" class="headerlink" title="语法"></a>语法</h2><p>AUTOINCREMENT 关键字的基本用法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE table_name(</span><br><span class="line">   column1 INTEGER AUTOINCREMENT,</span><br><span class="line">   column2 datatype,</span><br><span class="line">   column3 datatype,</span><br><span class="line">   .....</span><br><span class="line">   columnN datatype,</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-37"><a href="#实例-37" class="headerlink" title="实例"></a>实例</h2><p>假设要创建的 COMPANY 表如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE TABLE COMPANY(</span><br><span class="line">   ID INTEGER PRIMARY KEY   AUTOINCREMENT,</span><br><span class="line">   NAME           TEXT      NOT NULL,</span><br><span class="line">   AGE            INT       NOT NULL,</span><br><span class="line">   ADDRESS        CHAR(50),</span><br><span class="line">   SALARY         REAL</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>现在，向 COMPANY 表插入以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES ( &apos;Paul&apos;, 32, &apos;California&apos;, 20000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (&apos;Allen&apos;, 25, &apos;Texas&apos;, 15000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES (&apos;Teddy&apos;, 23, &apos;Norway&apos;, 20000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES ( &apos;Mark&apos;, 25, &apos;Rich-Mond &apos;, 65000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES ( &apos;David&apos;, 27, &apos;Texas&apos;, 85000.00 );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES ( &apos;Kim&apos;, 22, &apos;South-Hall&apos;, 45000.00 );</span><br><span class="line"></span><br><span class="line">INSERT INTO COMPANY (NAME,AGE,ADDRESS,SALARY)</span><br><span class="line">VALUES ( &apos;James&apos;, 24, &apos;Houston&apos;, 10000.00 );</span><br></pre></td></tr></table></figure></p>
<p>这将向 COMPANY 表插入 7 个元组，此时 COMPANY 表的记录如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-39"><a href="#Chapter-39" class="headerlink" title="Chapter 39"></a>Chapter 39</h1><h2 id="SQLite-注入"><a href="#SQLite-注入" class="headerlink" title="SQLite 注入"></a>SQLite 注入</h2><p>如果您的站点允许用户通过网页输入，并将输入内容插入到 SQLite 数据库中，这个时候您就面临着一个被称为 SQL 注入的安全问题。本章节将向您讲解如何防止这种情况的发生，<strong>确保脚本和 SQLite 语句的安全</strong>。</p>
<p>注入通常在请求用户输入时发生，比如需要用户输入姓名，但用户却输入了一个 SQLite 语句，而这语句就会在不知不觉中在数据库上运行。</p>
<p>永远不要相信用户提供的数据，所以只处理通过验证的数据，这项规则是通过模式匹配来完成的。在下面的实例中，用户名 username 被限制为字母数字字符或者下划线，长度必须在 8 到 20 个字符之间 - 请根据需要修改这些规则。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&quot;/^\w&#123;8,20&#125;$/&quot;, $_GET[&apos;username&apos;], $matches))&#123;</span><br><span class="line">   $db = new SQLiteDatabase(&apos;filename&apos;);</span><br><span class="line">   $result = @$db-&gt;query(&quot;SELECT * FROM users WHERE username=$matches[0]&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">   echo &quot;username not accepted&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>为了演示这个问题，假设考虑此摘录：To demonstrate the problem, consider this excerpt:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$name = &quot;Qadir&apos;; DELETE FROM users;&quot;;</span><br><span class="line">@$db-&gt;query(&quot;SELECT * FROM users WHERE username=&apos;&#123;$name&#125;&apos;&quot;);</span><br></pre></td></tr></table></figure></p>
<p>函数调用是为了从用户表中检索 name 列与用户指定的名称相匹配的记录。正常情况下，$name 只包含字母数字字符或者空格，比如字符串 ilia。但在这里，向 $name 追加了一个全新的查询，这个对数据库的调用将会造成灾难性的问题：注入的 DELETE 查询会删除 users 的所有记录。</p>
<p>虽然已经存在有不允许查询堆叠或在单个函数调用中执行多个查询的数据库接口，如果尝试堆叠查询，则会调用失败，但 SQLite 和 PostgreSQL 里仍进行堆叠查询，即执行在一个字符串中提供的所有查询，这会导致严重的安全问题。</p>
<h2 id="防止-SQL-注入"><a href="#防止-SQL-注入" class="headerlink" title="防止 SQL 注入"></a>防止 SQL 注入</h2><p>在脚本语言中，比如 PERL 和 PHP，您可以巧妙地处理所有的转义字符。编程语言 PHP 提供了字符串函数 SQLite3::escapeString($string) 和 sqlite_escape_string() 来转义对于 SQLite 来说比较特殊的输入字符。</p>
<p>注意：使用函数 sqlite_escape_string() 的 PHP 版本要求为 PHP 5 &lt; 5.4.0。</p>
<p>更高版本 PHP 5 &gt;= 5.3.0, PHP 7 使用以上函数:</p>
<p>SQLite3::escapeString($string);//$string为要转义的字符串</p>
<p>以下方式在最新版本的 PHP 中不支持：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (get_magic_quotes_gpc()) </span><br><span class="line">&#123;</span><br><span class="line">  $name = sqlite_escape_string($name);</span><br><span class="line">&#125;</span><br><span class="line">$result = @$db-&gt;query(&quot;SELECT * FROM users WHERE username=&apos;&#123;$name&#125;&apos;&quot;);</span><br></pre></td></tr></table></figure></p>
<p>虽然编码使得插入数据变得安全，但是它会呈现简单的文本比较，在查询中，对于包含二进制数据的列，LIKE 子句是不可用的。</p>
<p>请注意，addslashes() 不应该被用在 SQLite 查询中引用字符串，它会在检索数据时导致奇怪的结果。</p>
<h1 id="Chapter-40"><a href="#Chapter-40" class="headerlink" title="Chapter 40"></a>Chapter 40</h1><h2 id="SQLite-Explain（解释）"><a href="#SQLite-Explain（解释）" class="headerlink" title="SQLite Explain（解释）"></a>SQLite Explain（解释）</h2><p>在 SQLite 语句之前，可以使用 “EXPLAIN” 关键字或 “EXPLAIN QUERY PLAN” 短语，用于描述表的细节。</p>
<p>如果省略了 EXPLAIN 关键字或短语，任何的修改都会引起 SQLite 语句的查询行为，并返回有关 SQLite 语句如何操作的信息。</p>
<p><strong>来自 EXPLAIN 和 EXPLAIN QUERY PLAN 的输出只用于交互式分析和排除故障。</strong></p>
<p>输出格式的细节可能会随着 SQLite 版本的不同而有所变化。</p>
<p><strong>应用程序不应该使用 EXPLAIN 或 EXPLAIN QUERY PLAN，因为其确切的行为是可变的且只有部分会被记录。</strong></p>
<h2 id="语法-29"><a href="#语法-29" class="headerlink" title="语法"></a>语法</h2><p>EXPLAIN 的语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN [SQLite Query]</span><br></pre></td></tr></table></figure></p>
<p>EXPLAIN QUERY PLAN 的语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN  QUERY PLAN [SQLite Query]</span><br></pre></td></tr></table></figure></p>
<h2 id="实例-38"><a href="#实例-38" class="headerlink" title="实例"></a>实例</h2><p>假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们检查 SELECT 语句中的 Explain 使用：</p>
<p><code>sqlite&gt; EXPLAIN SELECT *  FROM COMPANY  WHERE Salary &gt;= 20000;</code><br>这将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">addr        opcode      p1          p2          p3</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">0           Goto        0           19</span><br><span class="line">1           Integer     0           0</span><br><span class="line">2           OpenRead    0           8</span><br><span class="line">3           SetNumColu  0           5</span><br><span class="line">4           Rewind      0           17</span><br><span class="line">5           Column      0           4</span><br><span class="line">6           RealAffini  0           0</span><br><span class="line">7           Integer     20000       0</span><br><span class="line">8           Lt          357         16          collseq(BI</span><br><span class="line">9           Rowid       0           0</span><br><span class="line">10          Column      0           1</span><br><span class="line">11          Column      0           2</span><br><span class="line">12          Column      0           3</span><br><span class="line">13          Column      0           4</span><br><span class="line">14          RealAffini  0           0</span><br><span class="line">15          Callback    5           0</span><br><span class="line">16          Next        0           5</span><br><span class="line">17          Close       0           0</span><br><span class="line">18          Halt        0           0</span><br><span class="line">19          Transactio  0           0</span><br><span class="line">20          VerifyCook  0           38</span><br><span class="line">21          Goto        0           1</span><br><span class="line">22          Noop        0           0</span><br></pre></td></tr></table></figure></p>
<p>现在，让我们检查 SELECT 语句中的 Explain Query Plan 使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQLite&gt; EXPLAIN QUERY PLAN SELECT * FROM COMPANY WHERE Salary &gt;= 20000;</span><br><span class="line">order       from        detail</span><br><span class="line">----------  ----------  -------------</span><br><span class="line">0           0           TABLE COMPANY</span><br></pre></td></tr></table></figure></p>
<h1 id="Chapter-41"><a href="#Chapter-41" class="headerlink" title="Chapter 41"></a>Chapter 41</h1><h2 id="SQLite-Vacuum"><a href="#SQLite-Vacuum" class="headerlink" title="SQLite Vacuum"></a>SQLite Vacuum</h2><p>VACUUM 命令通过复制主数据库中的内容到一个临时数据库文件，然后清空主数据库，并从副本中重新载入原始的数据库文件。<strong>这消除了空闲页，把表中的数据排列为连续的，另外会清理数据库文件结构。</strong></p>
<p>如果表中没有明确的整型主键（INTEGER PRIMARY KEY），VACUUM 命令可能会改变表中条目的行 ID（ROWID）。VACUUM 命令只适用于主数据库，附加的数据库文件是不可能使用 VACUUM 命令。</p>
<p>如果有一个活动的事务，VACUUM 命令就会失败。VACUUM 命令是一个用于内存数据库的任何操作。由于 VACUUM 命令从头开始重新创建数据库文件，所以 VACUUM 也可以用于修改许多数据库特定的配置参数。</p>
<h2 id="手动-VACUUM"><a href="#手动-VACUUM" class="headerlink" title="手动 VACUUM"></a>手动 VACUUM</h2><p>下面是在命令提示符中对整个数据库发出 VACUUM 命令的语法：</p>
<p><code>$sqlite3 database_name &quot;VACUUM;&quot;</code><br>您也可以在 SQLite 提示符中运行 VACUUM，如下所示：</p>
<p><code>sqlite&gt; VACUUM;</code><br>您也可以在特定的表上运行 VACUUM，如下所示：</p>
<p><code>sqlite&gt; VACUUM table_name;</code></p>
<h2 id="自动-VACUUM（Auto-VACUUM）"><a href="#自动-VACUUM（Auto-VACUUM）" class="headerlink" title="自动 VACUUM（Auto-VACUUM）"></a>自动 VACUUM（Auto-VACUUM）</h2><p>SQLite 的 Auto-VACUUM 与 VACUUM 不大一样，它只是把空闲页移到数据库末尾，从而减小数据库大小。通过这样做，它可以明显地把数据库碎片化，而 VACUUM 则是反碎片化。所以 Auto-VACUUM 只会让数据库更小。</p>
<p>在 SQLite 提示符中，您可以通过下面的编译运行，启用/禁用 SQLite 的 Auto-VACUUM：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; PRAGMA auto_vacuum = NONE;  -- 0 means disable auto vacuum</span><br><span class="line">sqlite&gt; PRAGMA auto_vacuum = INCREMENTAL;  -- 1 means enable incremental vacuum</span><br><span class="line">sqlite&gt; PRAGMA auto_vacuum = FULL;  -- 2 means enable full auto vacuum</span><br></pre></td></tr></table></figure></p>
<p>您可以从命令提示符中运行下面的命令来检查 auto-vacuum 设置：</p>
<p><code>$sqlite3 database_name &quot;PRAGMA auto_vacuum;&quot;</code></p>
<h1 id="Chapter-42"><a href="#Chapter-42" class="headerlink" title="Chapter 42"></a>Chapter 42</h1><h2 id="SQLite-日期-amp-时间"><a href="#SQLite-日期-amp-时间" class="headerlink" title="SQLite 日期 &amp; 时间"></a>SQLite 日期 &amp; 时间</h2><p>SQLite 支持以下五个日期和时间函数：</p>
<ul>
<li>序号    函数    实例</li>
<li>1    date(timestring, modifier, modifier, …)    以 YYYY-MM-DD 格式返回日期。</li>
<li>2    time(timestring, modifier, modifier, …)    以 HH:MM:SS 格式返回时间。</li>
<li>3    datetime(timestring, modifier, modifier, …)    以 YYYY-MM-DD HH:MM:SS 格式返回。</li>
<li>4    julianday(timestring, modifier, modifier, …)    这将返回从格林尼治时间的公元前 4714 年 11 月 24 日正午算起的天数。</li>
<li>5    strftime(format, timestring, modifier, modifier, …)    这将根据第一个参数指定的格式字符串返回格式化的日期。具体格式见下边讲解。<br>上述五个日期和时间函数把时间字符串作为参数。时间字符串后跟零个或多个 modifier 修饰符。strftime() 函数也可以把格式字符串 format 作为其第一个参数。下面将为您详细讲解不同类型的时间字符串和修饰符。</li>
</ul>
<h2 id="时间字符串"><a href="#时间字符串" class="headerlink" title="时间字符串"></a>时间字符串</h2><p>一个时间字符串可以采用下面任何一种格式：</p>
<ul>
<li>序号    时间字符串    实例</li>
<li>1    YYYY-MM-DD    2010-12-30</li>
<li>2    YYYY-MM-DD HH:MM    2010-12-30 12:10</li>
<li>3    YYYY-MM-DD HH:MM:SS.SSS    2010-12-30 12:10:04.100</li>
<li>4    MM-DD-YYYY HH:MM    30-12-2010 12:10</li>
<li>5    HH:MM    12:10</li>
<li>6    YYYY-MM-DDTHH:MM    2010-12-30 12:10</li>
<li>7    HH:MM:SS    12:10:01</li>
<li>8    YYYYMMDD HHMMSS    20101230 121001</li>
<li>9    now    2013-05-07</li>
<li>您可以使用 “T” 作为分隔日期和时间的文字字符。</li>
</ul>
<h2 id="修饰符（Modifier）"><a href="#修饰符（Modifier）" class="headerlink" title="修饰符（Modifier）"></a>修饰符（Modifier）</h2><p>时间字符串后边可跟着零个或多个的修饰符，这将改变有上述五个函数返回的日期和/或时间。任何上述五大功能返回时间。修饰符应从左到右使用，下面列出了可在 SQLite 中使用的修饰符：</p>
<ul>
<li><p>NNN days</p>
</li>
<li><p>NNN hours</p>
</li>
<li><p>NNN minutes</p>
</li>
<li><p>NNN.NNNN seconds</p>
</li>
<li><p>NNN months</p>
</li>
<li><p>NNN years</p>
</li>
<li><p>start of month</p>
</li>
<li><p>start of year</p>
</li>
<li><p>start of day</p>
</li>
<li><p>weekday N</p>
</li>
<li><p>unixepoch</p>
</li>
<li><p>localtime</p>
</li>
<li><p>utc</p>
</li>
</ul>
<h2 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h2><p>SQLite 提供了非常方便的函数 strftime() 来格式化任何日期和时间。您可以使用以下的替换来格式化日期和时间：</p>
<ul>
<li>替换    描述</li>
<li>%d    一月中的第几天，01-31</li>
<li>%f    带小数部分的秒，SS.SSS</li>
<li>%H    小时，00-23</li>
<li>%j    一年中的第几天，001-366</li>
<li>%J    儒略日数，DDDD.DDDD</li>
<li>%m    月，00-12</li>
<li>%M    分，00-59</li>
<li>%s    从 1970-01-01 算起的秒数</li>
<li>%S    秒，00-59</li>
<li>%w    一周中的第几天，0-6 (0 is Sunday)</li>
<li>%W    一年中的第几周，01-53</li>
<li>%Y    年，YYYY</li>
<li>%%    % symbol</li>
</ul>
<h2 id="实例-39"><a href="#实例-39" class="headerlink" title="实例"></a>实例</h2><p>现在让我们使用 SQLite 提示符尝试不同的实例。</p>
<p><strong>下面是计算当前日期：</strong></p>
<p><strong>sqlite&gt; SELECT date(‘now’);</strong></p>
<p>2013-05-07</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">下面是计算当前月份的最后一天：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT date(&apos;now&apos;,&apos;start of month&apos;,&apos;+1 month&apos;,&apos;-1 day&apos;);</span><br><span class="line">2013-05-31</span><br><span class="line">下面是计算给定 UNIX 时间戳 1092941466 的日期和时间：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT datetime(1092941466, &apos;unixepoch&apos;);</span><br><span class="line">2004-08-19 18:51:06</span><br><span class="line">下面是计算给定 UNIX 时间戳 1092941466 相对本地时区的日期和时间：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT datetime(1092941466, &apos;unixepoch&apos;, &apos;localtime&apos;);</span><br><span class="line">2004-08-19 11:51:06</span><br><span class="line">下面是计算当前的 UNIX 时间戳：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT strftime(&apos;%s&apos;,&apos;now&apos;);</span><br><span class="line">1367926057</span><br><span class="line">下面是计算美国&quot;独立宣言&quot;签署以来的天数：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT julianday(&apos;now&apos;) - julianday(&apos;1776-07-04&apos;);</span><br><span class="line">86504.4775830326</span><br><span class="line">下面是计算从 2004 年某一特定时刻以来的秒数：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT strftime(&apos;%s&apos;,&apos;now&apos;) - strftime(&apos;%s&apos;,&apos;2004-01-01 02:34:56&apos;);</span><br><span class="line">295001572</span><br><span class="line">下面是计算当年 10 月的第一个星期二的日期：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT date(&apos;now&apos;,&apos;start of year&apos;,&apos;+9 months&apos;,&apos;weekday 2&apos;);</span><br><span class="line">2013-10-01</span><br><span class="line">下面是计算从 UNIX 纪元算起的以秒为单位的时间（类似 strftime(&apos;%s&apos;,&apos;now&apos;) ，不同的是这里有包括小数部分）：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT (julianday(&apos;now&apos;) - 2440587.5)*86400.0;</span><br><span class="line">1367926077.12598</span><br><span class="line">在 UTC 与本地时间值之间进行转换，当格式化日期时，使用 utc 或 localtime 修饰符，如下所示：</span><br><span class="line"></span><br><span class="line">sqlite&gt; SELECT time(&apos;12:00&apos;, &apos;localtime&apos;);</span><br><span class="line">05:00:00</span><br><span class="line">sqlite&gt;  SELECT time(&apos;12:00&apos;, &apos;utc&apos;);</span><br><span class="line">19:00:00</span><br></pre></td></tr></table></figure>
<h1 id="Chapter-43"><a href="#Chapter-43" class="headerlink" title="Chapter 43"></a>Chapter 43</h1><h2 id="SQLite-常用函数"><a href="#SQLite-常用函数" class="headerlink" title="SQLite 常用函数"></a>SQLite 常用函数</h2><p>SQLite 有许多内置函数用于处理字符串或数字数据。下面列出了一些有用的 SQLite 内置函数，且所有函数都是大小写不敏感，这意味着您可以使用这些函数的小写形式或大写形式或混合形式。欲了解更多详情，请查看 SQLite 的官方文档：</p>
<ul>
<li>序号    函数 &amp; 描述</li>
<li>1    SQLite COUNT 函数</li>
<li>SQLite COUNT 聚集函数是用来计算一个数据库表中的行数。</li>
<li>2    SQLite MAX 函数</li>
<li>SQLite MAX 聚合函数允许我们选择某列的最大值。</li>
<li>3    SQLite MIN 函数</li>
<li>SQLite MIN 聚合函数允许我们选择某列的最小值。</li>
<li>4    SQLite AVG 函数</li>
<li>SQLite AVG 聚合函数计算某列的平均值。</li>
<li>5    SQLite SUM 函数</li>
<li>SQLite SUM 聚合函数允许为一个数值列计算总和。</li>
<li>6    SQLite RANDOM 函数</li>
<li>SQLite RANDOM 函数返回一个介于 -9223372036854775808 和 +9223372036854775807 之间的伪随机整数。</li>
<li>7    SQLite ABS 函数</li>
<li>SQLite ABS 函数返回数值参数的绝对值。</li>
<li>8    SQLite UPPER 函数</li>
<li>SQLite UPPER 函数把字符串转换为大写字母。</li>
<li>9    SQLite LOWER 函数</li>
<li>SQLite LOWER 函数把字符串转换为小写字母。</li>
<li>10    SQLite LENGTH 函数</li>
<li>SQLite LENGTH 函数返回字符串的长度。</li>
<li>11    SQLite sqlite_version 函数</li>
<li>SQLite sqlite_version 函数返回 SQLite 库的版本。</li>
</ul>
<p>在我们开始讲解这些函数实例之前，先假设 COMPANY 表有以下记录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ID          NAME        AGE         ADDRESS     SALARY</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">1           Paul        32          California  20000.0</span><br><span class="line">2           Allen       25          Texas       15000.0</span><br><span class="line">3           Teddy       23          Norway      20000.0</span><br><span class="line">4           Mark        25          Rich-Mond   65000.0</span><br><span class="line">5           David       27          Texas       85000.0</span><br><span class="line">6           Kim         22          South-Hall  45000.0</span><br><span class="line">7           James       24          Houston     10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-COUNT-函数"><a href="#SQLite-COUNT-函数" class="headerlink" title="SQLite COUNT 函数"></a>SQLite COUNT 函数</h2><p>SQLite COUNT 聚集函数是用来计算一个数据库表中的行数。下面是实例：</p>
<p><code>sqlite&gt; SELECT count(*) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">count(*)</span><br><span class="line">----------</span><br><span class="line">7</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-MAX-函数"><a href="#SQLite-MAX-函数" class="headerlink" title="SQLite MAX 函数"></a>SQLite MAX 函数</h2><p>SQLite MAX 聚合函数允许我们选择某列的最大值。下面是实例：</p>
<p><code>sqlite&gt; SELECT max(salary) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">max(salary)</span><br><span class="line">-----------</span><br><span class="line">85000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-MIN-函数"><a href="#SQLite-MIN-函数" class="headerlink" title="SQLite MIN 函数"></a>SQLite MIN 函数</h2><p>SQLite MIN 聚合函数允许我们选择某列的最小值。下面是实例：</p>
<p><code>sqlite&gt; SELECT min(salary) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">min(salary)</span><br><span class="line">-----------</span><br><span class="line">10000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-AVG-函数"><a href="#SQLite-AVG-函数" class="headerlink" title="SQLite AVG 函数"></a>SQLite AVG 函数</h2><p>SQLite AVG 聚合函数计算某列的平均值。下面是实例：</p>
<p><code>sqlite&gt; SELECT avg(salary) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">avg(salary)</span><br><span class="line">----------------</span><br><span class="line">37142.8571428572</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-SUM-函数"><a href="#SQLite-SUM-函数" class="headerlink" title="SQLite SUM 函数"></a>SQLite SUM 函数</h2><p>SQLite SUM 聚合函数允许为一个数值列计算总和。下面是实例：</p>
<p><code>sqlite&gt; SELECT sum(salary) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sum(salary)</span><br><span class="line">-----------</span><br><span class="line">260000.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-RANDOM-函数"><a href="#SQLite-RANDOM-函数" class="headerlink" title="SQLite RANDOM 函数"></a>SQLite RANDOM 函数</h2><p>SQLite RANDOM 函数返回一个介于 -9223372036854775808 和 +9223372036854775807 之间的伪随机整数。下面是实例：</p>
<p><code>sqlite&gt; SELECT random() AS Random;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Random</span><br><span class="line">-------------------</span><br><span class="line">5876796417670984050</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-ABS-函数"><a href="#SQLite-ABS-函数" class="headerlink" title="SQLite ABS 函数"></a>SQLite ABS 函数</h2><p>SQLite ABS 函数返回数值参数的绝对值。下面是实例：</p>
<p><code>sqlite&gt; SELECT abs(5), abs(-15), abs(NULL), abs(0), abs(&quot;ABC&quot;);</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abs(5)      abs(-15)    abs(NULL)   abs(0)      abs(&quot;ABC&quot;)</span><br><span class="line">----------  ----------  ----------  ----------  ----------</span><br><span class="line">5           15                      0           0.0</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-UPPER-函数"><a href="#SQLite-UPPER-函数" class="headerlink" title="SQLite UPPER 函数"></a>SQLite UPPER 函数</h2><p>SQLite UPPER 函数把字符串转换为大写字母。下面是实例：</p>
<p><code>sqlite&gt; SELECT upper(name) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">upper(name)</span><br><span class="line">-----------</span><br><span class="line">PAUL</span><br><span class="line">ALLEN</span><br><span class="line">TEDDY</span><br><span class="line">MARK</span><br><span class="line">DAVID</span><br><span class="line">KIM</span><br><span class="line">JAMES</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-LOWER-函数"><a href="#SQLite-LOWER-函数" class="headerlink" title="SQLite LOWER 函数"></a>SQLite LOWER 函数</h2><p>SQLite LOWER 函数把字符串转换为小写字母。下面是实例：</p>
<p><code>sqlite&gt; SELECT lower(name) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lower(name)</span><br><span class="line">-----------</span><br><span class="line">paul</span><br><span class="line">allen</span><br><span class="line">teddy</span><br><span class="line">mark</span><br><span class="line">david</span><br><span class="line">kim</span><br><span class="line">james</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-LENGTH-函数"><a href="#SQLite-LENGTH-函数" class="headerlink" title="SQLite LENGTH 函数"></a>SQLite LENGTH 函数</h2><p>SQLite LENGTH 函数返回字符串的长度。下面是实例：</p>
<p><code>sqlite&gt; SELECT name, length(name) FROM COMPANY;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME        length(name)</span><br><span class="line">----------  ------------</span><br><span class="line">Paul        4</span><br><span class="line">Allen       5</span><br><span class="line">Teddy       5</span><br><span class="line">Mark        4</span><br><span class="line">David       5</span><br><span class="line">Kim         3</span><br><span class="line">James       5</span><br></pre></td></tr></table></figure></p>
<h2 id="SQLite-sqlite-version-函数"><a href="#SQLite-sqlite-version-函数" class="headerlink" title="SQLite sqlite_version 函数"></a>SQLite sqlite_version 函数</h2><p>SQLite sqlite_version 函数返回 SQLite 库的版本。下面是实例：</p>
<p><code>sqlite&gt; SELECT sqlite_version() AS &#39;SQLite Version&#39;;</code><br>上面的 SQLite SQL 语句将产生以下结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQLite Version</span><br><span class="line">--------------</span><br><span class="line">3.6.20</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Donate? comment?</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat.jpg" alt="zzm99 WeChat Pay">
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/zhifubao.jpg" alt="zzm99 Alipay">
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/09/leetcode-301/" rel="next" title="leetcode-301-Remove Invalid Parentheses">
                <i class="fa fa-chevron-left"></i> leetcode-301-Remove Invalid Parentheses
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/12/sqliteCpp/" rel="prev" title="sqlite与c++的接口">
                sqlite与c++的接口 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="zzm99">
            
              <p class="site-author-name" itemprop="name">zzm99</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">315</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">40</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zzm99" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-1"><span class="nav-number">1.</span> <span class="nav-text">Chapter 1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-命令"><span class="nav-number">1.1.</span> <span class="nav-text">SQLite 命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DDL-数据定义语言DDL-数据定义语言"><span class="nav-number">1.1.1.</span> <span class="nav-text">DDL - 数据定义语言DDL - 数据定义语言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DML-数据操作语言"><span class="nav-number">1.1.2.</span> <span class="nav-text">DML - 数据操作语言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DQL-数据查询语言"><span class="nav-number">1.1.3.</span> <span class="nav-text">DQL - 数据查询语言</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-2"><span class="nav-number">2.</span> <span class="nav-text">Chapter 2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-命令-1"><span class="nav-number">2.1.</span> <span class="nav-text">SQLite 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#格式化输出"><span class="nav-number">2.2.</span> <span class="nav-text">格式化输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sqlite-master-表格"><span class="nav-number">2.3.</span> <span class="nav-text">sqlite_master 表格</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-3"><span class="nav-number">3.</span> <span class="nav-text">Chapter 3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-语法"><span class="nav-number">3.1.</span> <span class="nav-text">SQLite 语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#大小写敏感性"><span class="nav-number">3.1.1.</span> <span class="nav-text">大小写敏感性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释"><span class="nav-number">3.1.2.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQLite-语句"><span class="nav-number">3.1.3.</span> <span class="nav-text">SQLite 语句</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-4"><span class="nav-number">4.</span> <span class="nav-text">Chapter 4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-数据类型"><span class="nav-number">4.1.</span> <span class="nav-text">SQLite 数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-存储类"><span class="nav-number">4.2.</span> <span class="nav-text">SQLite 存储类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-亲和-Affinity-类型"><span class="nav-number">4.3.</span> <span class="nav-text">SQLite 亲和(Affinity)类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-亲和类型-Affinity-及类型名称"><span class="nav-number">4.4.</span> <span class="nav-text">SQLite 亲和类型(Affinity)及类型名称</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Boolean-数据类型"><span class="nav-number">4.5.</span> <span class="nav-text">Boolean 数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Date-与-Time-数据类型"><span class="nav-number">4.6.</span> <span class="nav-text">Date 与 Time 数据类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-5"><span class="nav-number">5.</span> <span class="nav-text">Chapter 5</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-创建数据库"><span class="nav-number">5.1.</span> <span class="nav-text">SQLite 创建数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例"><span class="nav-number">5.2.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dump-命令"><span class="nav-number">5.3.</span> <span class="nav-text">.dump 命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-6"><span class="nav-number">6.</span> <span class="nav-text">Chapter 6</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-附加数据库"><span class="nav-number">6.1.</span> <span class="nav-text">SQLite 附加数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法"><span class="nav-number">6.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-1"><span class="nav-number">6.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-7"><span class="nav-number">7.</span> <span class="nav-text">Chapter 7</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-分离数据库"><span class="nav-number">7.1.</span> <span class="nav-text">SQLite 分离数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-1"><span class="nav-number">7.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-2"><span class="nav-number">7.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-8"><span class="nav-number">8.</span> <span class="nav-text">Chapter 8</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-创建表"><span class="nav-number">8.1.</span> <span class="nav-text">SQLite 创建表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-2"><span class="nav-number">8.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-3"><span class="nav-number">8.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-9"><span class="nav-number">9.</span> <span class="nav-text">Chapter 9</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-删除表"><span class="nav-number">9.1.</span> <span class="nav-text">SQLite 删除表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-3"><span class="nav-number">9.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-4"><span class="nav-number">9.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-10"><span class="nav-number">10.</span> <span class="nav-text">Chapter 10</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Insert-语句"><span class="nav-number">10.1.</span> <span class="nav-text">SQLite Insert 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-4"><span class="nav-number">10.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-5"><span class="nav-number">10.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用一个表来填充另一个表"><span class="nav-number">10.4.</span> <span class="nav-text">使用一个表来填充另一个表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-11"><span class="nav-number">11.</span> <span class="nav-text">Chapter 11</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Select-语句"><span class="nav-number">11.1.</span> <span class="nav-text">SQLite Select 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-5"><span class="nav-number">11.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-6"><span class="nav-number">11.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Schema-信息"><span class="nav-number">11.4.</span> <span class="nav-text">Schema 信息</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-12"><span class="nav-number">12.</span> <span class="nav-text">Chapter 12</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-运算符"><span class="nav-number">12.1.</span> <span class="nav-text">SQLite 运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-运算符是什么？"><span class="nav-number">12.2.</span> <span class="nav-text">SQLite 运算符是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-算术运算符"><span class="nav-number">12.3.</span> <span class="nav-text">SQLite 算术运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-7"><span class="nav-number">12.4.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-比较运算符"><span class="nav-number">12.5.</span> <span class="nav-text">SQLite 比较运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-8"><span class="nav-number">12.6.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-逻辑运算符"><span class="nav-number">12.7.</span> <span class="nav-text">SQLite 逻辑运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-9"><span class="nav-number">12.8.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-位运算符"><span class="nav-number">12.9.</span> <span class="nav-text">SQLite 位运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-10"><span class="nav-number">12.10.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-13"><span class="nav-number">13.</span> <span class="nav-text">Chapter 13</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-表达式"><span class="nav-number">13.1.</span> <span class="nav-text">SQLite 表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-6"><span class="nav-number">13.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-布尔表达式"><span class="nav-number">13.3.</span> <span class="nav-text">SQLite - 布尔表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-数值表达式"><span class="nav-number">13.4.</span> <span class="nav-text">SQLite - 数值表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#这些表达式用来执行查询中的任何数学运算。语法如下："><span class="nav-number">13.5.</span> <span class="nav-text">这些表达式用来执行查询中的任何数学运算。语法如下：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-日期表达式"><span class="nav-number">13.6.</span> <span class="nav-text">SQLite - 日期表达式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-14"><span class="nav-number">14.</span> <span class="nav-text">Chapter 14</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Where-子句"><span class="nav-number">14.1.</span> <span class="nav-text">SQLite Where 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-7"><span class="nav-number">14.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-11"><span class="nav-number">14.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-15"><span class="nav-number">15.</span> <span class="nav-text">Chapter 15</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-AND-OR-运算符"><span class="nav-number">15.1.</span> <span class="nav-text">SQLite AND/OR 运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AND-运算符"><span class="nav-number">15.2.</span> <span class="nav-text">AND 运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-8"><span class="nav-number">15.3.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-12"><span class="nav-number">15.4.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OR-运算符"><span class="nav-number">15.5.</span> <span class="nav-text">OR 运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-9"><span class="nav-number">15.6.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-13"><span class="nav-number">15.7.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-16"><span class="nav-number">16.</span> <span class="nav-text">Chapter 16</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Update-语句"><span class="nav-number">16.1.</span> <span class="nav-text">SQLite Update 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-10"><span class="nav-number">16.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-14"><span class="nav-number">16.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-17"><span class="nav-number">17.</span> <span class="nav-text">Chapter 17</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Delete-语句"><span class="nav-number">17.1.</span> <span class="nav-text">SQLite Delete 语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-11"><span class="nav-number">17.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-15"><span class="nav-number">17.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-18"><span class="nav-number">18.</span> <span class="nav-text">Chapter 18</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Like-子句"><span class="nav-number">18.1.</span> <span class="nav-text">SQLite Like 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-12"><span class="nav-number">18.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-16"><span class="nav-number">18.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-19"><span class="nav-number">19.</span> <span class="nav-text">Chapter 19</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Glob-子句"><span class="nav-number">19.1.</span> <span class="nav-text">SQLite Glob 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-13"><span class="nav-number">19.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-17"><span class="nav-number">19.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-20"><span class="nav-number">20.</span> <span class="nav-text">Chapter 20</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Limit-子句"><span class="nav-number">20.1.</span> <span class="nav-text">SQLite Limit 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-14"><span class="nav-number">20.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-18"><span class="nav-number">20.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-21"><span class="nav-number">21.</span> <span class="nav-text">Chapter 21</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Order-By"><span class="nav-number">21.1.</span> <span class="nav-text">SQLite Order By</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-15"><span class="nav-number">21.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-19"><span class="nav-number">21.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-22"><span class="nav-number">22.</span> <span class="nav-text">Chapter 22</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Group-By"><span class="nav-number">22.1.</span> <span class="nav-text">SQLite Group By</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-16"><span class="nav-number">22.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-20"><span class="nav-number">22.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-23"><span class="nav-number">23.</span> <span class="nav-text">Chapter 23</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Having-子句"><span class="nav-number">23.1.</span> <span class="nav-text">SQLite Having 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-17"><span class="nav-number">23.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-21"><span class="nav-number">23.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-24"><span class="nav-number">24.</span> <span class="nav-text">Chapter 24</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Distinct-关键字"><span class="nav-number">24.1.</span> <span class="nav-text">SQLite Distinct 关键字</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-18"><span class="nav-number">24.2.</span> <span class="nav-text">语法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-25"><span class="nav-number">25.</span> <span class="nav-text">Chapter 25</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-PRAGMA"><span class="nav-number">25.1.</span> <span class="nav-text">SQLite PRAGMA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-19"><span class="nav-number">25.2.</span> <span class="nav-text">语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#auto-vacuum-Pragma"><span class="nav-number">25.2.1.</span> <span class="nav-text">auto_vacuum Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case-sensitive-like-Pragma"><span class="nav-number">25.2.2.</span> <span class="nav-text">case_sensitive_like Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#count-changes-Pragma"><span class="nav-number">25.2.3.</span> <span class="nav-text">count_changes Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#database-list-Pragma"><span class="nav-number">25.2.4.</span> <span class="nav-text">database_list Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#encoding-Pragma"><span class="nav-number">25.2.5.</span> <span class="nav-text">encoding Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#freelist-count-Pragma"><span class="nav-number">25.2.6.</span> <span class="nav-text">freelist_count Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#index-info-Pragma"><span class="nav-number">25.2.7.</span> <span class="nav-text">index_info Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#index-list-Pragma"><span class="nav-number">25.2.8.</span> <span class="nav-text">index_list Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#journal-mode-Pragma"><span class="nav-number">25.2.9.</span> <span class="nav-text">journal_mode Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#page-count-Pragma"><span class="nav-number">25.2.10.</span> <span class="nav-text">page_count Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#page-size-Pragma"><span class="nav-number">25.2.11.</span> <span class="nav-text">page_size Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#parser-trace-Pragma"><span class="nav-number">25.2.12.</span> <span class="nav-text">parser_trace Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#recursive-triggers-Pragma"><span class="nav-number">25.2.13.</span> <span class="nav-text">recursive_triggers Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#schema-version-Pragma"><span class="nav-number">25.2.14.</span> <span class="nav-text">schema_version Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#secure-delete-Pragma"><span class="nav-number">25.2.15.</span> <span class="nav-text">secure_delete Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sql-trace-Pragma"><span class="nav-number">25.2.16.</span> <span class="nav-text">sql_trace Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#synchronous-Pragma"><span class="nav-number">25.2.17.</span> <span class="nav-text">synchronous Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#temp-store-Pragma"><span class="nav-number">25.2.18.</span> <span class="nav-text">temp_store Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#temp-store-directory-Pragma"><span class="nav-number">25.2.19.</span> <span class="nav-text">temp_store_directory Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#user-version-Pragma"><span class="nav-number">25.2.20.</span> <span class="nav-text">user_version Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#writable-schema-Pragma"><span class="nav-number">25.2.21.</span> <span class="nav-text">writable_schema Pragma</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-26"><span class="nav-number">26.</span> <span class="nav-text">Chapter 26</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Join"><span class="nav-number">26.1.</span> <span class="nav-text">SQLite Join</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL-定义了三种主要类型的连接："><span class="nav-number">26.2.</span> <span class="nav-text">SQL 定义了三种主要类型的连接：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#交叉连接-CROSS-JOIN"><span class="nav-number">26.3.</span> <span class="nav-text">交叉连接 - CROSS JOIN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内连接-INNER-JOIN"><span class="nav-number">26.4.</span> <span class="nav-text">内连接 - INNER JOIN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#外连接-OUTER-JOIN"><span class="nav-number">26.5.</span> <span class="nav-text">外连接 - OUTER JOIN</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-27"><span class="nav-number">27.</span> <span class="nav-text">Chapter 27</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Unions-子句"><span class="nav-number">27.1.</span> <span class="nav-text">SQLite Unions 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-20"><span class="nav-number">27.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-22"><span class="nav-number">27.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UNION-ALL-子句"><span class="nav-number">27.4.</span> <span class="nav-text">UNION ALL 子句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-21"><span class="nav-number">27.5.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-23"><span class="nav-number">27.6.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-28"><span class="nav-number">28.</span> <span class="nav-text">Chapter 28</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-NULL-值"><span class="nav-number">28.1.</span> <span class="nav-text">SQLite NULL 值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-22"><span class="nav-number">28.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-24"><span class="nav-number">28.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-29"><span class="nav-number">29.</span> <span class="nav-text">Chapter 29</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-别名"><span class="nav-number">29.1.</span> <span class="nav-text">SQLite 别名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-23"><span class="nav-number">29.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-25"><span class="nav-number">29.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-30"><span class="nav-number">30.</span> <span class="nav-text">Chapter 30</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-触发器（Trigger）"><span class="nav-number">30.1.</span> <span class="nav-text">SQLite 触发器（Trigger）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-24"><span class="nav-number">30.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-26"><span class="nav-number">30.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出触发器（TRIGGERS）"><span class="nav-number">30.4.</span> <span class="nav-text">列出触发器（TRIGGERS）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除触发器（TRIGGERS）"><span class="nav-number">30.5.</span> <span class="nav-text">删除触发器（TRIGGERS）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-31"><span class="nav-number">31.</span> <span class="nav-text">Chapter 31</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-索引（Index）"><span class="nav-number">31.1.</span> <span class="nav-text">SQLite 索引（Index）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-INDEX-命令"><span class="nav-number">31.2.</span> <span class="nav-text">CREATE INDEX 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单列索引"><span class="nav-number">31.3.</span> <span class="nav-text">单列索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#唯一索引"><span class="nav-number">31.4.</span> <span class="nav-text">唯一索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组合索引"><span class="nav-number">31.5.</span> <span class="nav-text">组合索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#隐式索引"><span class="nav-number">31.6.</span> <span class="nav-text">隐式索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-27"><span class="nav-number">31.7.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DROP-INDEX-命令"><span class="nav-number">31.8.</span> <span class="nav-text">DROP INDEX 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么情况下要避免使用索引？"><span class="nav-number">31.9.</span> <span class="nav-text">什么情况下要避免使用索引？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-32"><span class="nav-number">32.</span> <span class="nav-text">Chapter 32</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Indexed-By"><span class="nav-number">32.1.</span> <span class="nav-text">SQLite Indexed By</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-25"><span class="nav-number">32.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-28"><span class="nav-number">32.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-33"><span class="nav-number">33.</span> <span class="nav-text">Chapter 33</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Alter-命令"><span class="nav-number">33.1.</span> <span class="nav-text">SQLite Alter 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-26"><span class="nav-number">33.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-29"><span class="nav-number">33.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-34"><span class="nav-number">34.</span> <span class="nav-text">Chapter 34</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Truncate-Table"><span class="nav-number">34.1.</span> <span class="nav-text">SQLite Truncate Table</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-27"><span class="nav-number">34.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-30"><span class="nav-number">34.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-35"><span class="nav-number">35.</span> <span class="nav-text">Chapter 35</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-视图（View）"><span class="nav-number">35.1.</span> <span class="nav-text">SQLite 视图（View）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建视图"><span class="nav-number">35.2.</span> <span class="nav-text">创建视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-31"><span class="nav-number">35.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-36"><span class="nav-number">36.</span> <span class="nav-text">Chapter 36</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-事务（Transaction）"><span class="nav-number">36.1.</span> <span class="nav-text">SQLite 事务（Transaction）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务的属性"><span class="nav-number">36.2.</span> <span class="nav-text">事务的属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务控制"><span class="nav-number">36.3.</span> <span class="nav-text">事务控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BEGIN-TRANSACTION-命令"><span class="nav-number">36.4.</span> <span class="nav-text">BEGIN TRANSACTION 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#COMMIT-命令"><span class="nav-number">36.5.</span> <span class="nav-text">COMMIT 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROLLBACK-命令"><span class="nav-number">36.6.</span> <span class="nav-text">ROLLBACK 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-32"><span class="nav-number">36.7.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-37"><span class="nav-number">37.</span> <span class="nav-text">Chapter 37</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-子查询"><span class="nav-number">37.1.</span> <span class="nav-text">SQLite 子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT-语句中的子查询使用"><span class="nav-number">37.2.</span> <span class="nav-text">SELECT 语句中的子查询使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-33"><span class="nav-number">37.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT-语句中的子查询使用"><span class="nav-number">37.4.</span> <span class="nav-text">INSERT 语句中的子查询使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本语法如下："><span class="nav-number">37.5.</span> <span class="nav-text">基本语法如下：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-34"><span class="nav-number">37.6.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE-语句中的子查询使用"><span class="nav-number">37.7.</span> <span class="nav-text">UPDATE 语句中的子查询使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本语法如下：-1"><span class="nav-number">37.8.</span> <span class="nav-text">基本语法如下：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-35"><span class="nav-number">37.9.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE-语句中的子查询使用"><span class="nav-number">37.10.</span> <span class="nav-text">DELETE 语句中的子查询使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本语法如下：-2"><span class="nav-number">37.11.</span> <span class="nav-text">基本语法如下：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-36"><span class="nav-number">37.12.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-38"><span class="nav-number">38.</span> <span class="nav-text">Chapter 38</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Autoincrement（自动递增）"><span class="nav-number">38.1.</span> <span class="nav-text">SQLite Autoincrement（自动递增）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-28"><span class="nav-number">38.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-37"><span class="nav-number">38.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-39"><span class="nav-number">39.</span> <span class="nav-text">Chapter 39</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-注入"><span class="nav-number">39.1.</span> <span class="nav-text">SQLite 注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#防止-SQL-注入"><span class="nav-number">39.2.</span> <span class="nav-text">防止 SQL 注入</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-40"><span class="nav-number">40.</span> <span class="nav-text">Chapter 40</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Explain（解释）"><span class="nav-number">40.1.</span> <span class="nav-text">SQLite Explain（解释）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语法-29"><span class="nav-number">40.2.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-38"><span class="nav-number">40.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-41"><span class="nav-number">41.</span> <span class="nav-text">Chapter 41</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-Vacuum"><span class="nav-number">41.1.</span> <span class="nav-text">SQLite Vacuum</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#手动-VACUUM"><span class="nav-number">41.2.</span> <span class="nav-text">手动 VACUUM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自动-VACUUM（Auto-VACUUM）"><span class="nav-number">41.3.</span> <span class="nav-text">自动 VACUUM（Auto-VACUUM）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-42"><span class="nav-number">42.</span> <span class="nav-text">Chapter 42</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-日期-amp-时间"><span class="nav-number">42.1.</span> <span class="nav-text">SQLite 日期 &amp; 时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间字符串"><span class="nav-number">42.2.</span> <span class="nav-text">时间字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修饰符（Modifier）"><span class="nav-number">42.3.</span> <span class="nav-text">修饰符（Modifier）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#格式化"><span class="nav-number">42.4.</span> <span class="nav-text">格式化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例-39"><span class="nav-number">42.5.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-43"><span class="nav-number">43.</span> <span class="nav-text">Chapter 43</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-常用函数"><span class="nav-number">43.1.</span> <span class="nav-text">SQLite 常用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-COUNT-函数"><span class="nav-number">43.2.</span> <span class="nav-text">SQLite COUNT 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-MAX-函数"><span class="nav-number">43.3.</span> <span class="nav-text">SQLite MAX 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-MIN-函数"><span class="nav-number">43.4.</span> <span class="nav-text">SQLite MIN 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-AVG-函数"><span class="nav-number">43.5.</span> <span class="nav-text">SQLite AVG 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-SUM-函数"><span class="nav-number">43.6.</span> <span class="nav-text">SQLite SUM 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-RANDOM-函数"><span class="nav-number">43.7.</span> <span class="nav-text">SQLite RANDOM 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-ABS-函数"><span class="nav-number">43.8.</span> <span class="nav-text">SQLite ABS 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-UPPER-函数"><span class="nav-number">43.9.</span> <span class="nav-text">SQLite UPPER 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-LOWER-函数"><span class="nav-number">43.10.</span> <span class="nav-text">SQLite LOWER 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-LENGTH-函数"><span class="nav-number">43.11.</span> <span class="nav-text">SQLite LENGTH 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLite-sqlite-version-函数"><span class="nav-number">43.12.</span> <span class="nav-text">SQLite sqlite_version 函数</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zzm99</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">379.4k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'tCb3SA6mqeAq2F28wecWLXyU-gzGzoHsz',
        appKey: 'xqRqUNcwfzn1jIhCov5sNS9G',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  


  <!-- 页面点击小红心 
  <script type="text/javascript" src="/js/src/click.js"></script>
  -->

<!-- 爆炸 
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
-->

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":0.8,"hHeadPos":0.5,"vHeadPos":0.5,"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"superSample":2,"width":200,"height":450,"position":"left","hOffset":0,"vOffset":0},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.9,"opacityOnHover":0.9},"log":false});</script></body>
</html>
